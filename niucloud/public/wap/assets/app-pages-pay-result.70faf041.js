import{bE as t,d as e,r as a,j as s,s as l,L as o,o as u,c as r,w as n,b as i,B as c,E as p,F as m,u as d,f,n as x,a as y,bF as _,G as v,i as h,g,h as j,a8 as b}from"./index-d5155418.js";import{_ as w}from"./u-button.a1b01a2c.js";import{_ as C}from"./u-loading-icon.15e9cfe2.js";import{_ as S}from"./u-modal.bebc0c9a.js";import"./u-icon.0f8fe390.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.d7569bea.js";import"./u-popup.51692bc0.js";import"./u-transition.b7ca8cae.js";import"./u-safe-bottom.e620f640.js";const T=e({__name:"result",setup(e){const T=a(null),E=a(!1);let F="",L=0,$=0;s((t=>{F=t.trade_type,L=t.trade_id,k()}));const k=()=>{(function(e,a){return t.get(`pay/info/${e}/${a}`,{},{showErrorMessage:!0})})(F,L).then((t=>{if(!uni.$u.test.isEmpty(t.data)){if(1==t.data.status&&$<5)return E.value=!0,$++,void setTimeout((()=>{k()}),1e3);T.value=t.data,E.value=!1,l({title:2==T.value.status?o("pay.paySuccess"):o("pay.payFail")})}}))},z=()=>{var t;const e=decodeURIComponent(uni.getStorageSync("payReturn"));y(e?{url:e,mode:"reLaunch"}:{url:_(),param:{code:null==(t=T.value)?void 0:t.out_trade_no},mode:"reLaunch"})};return(t,e)=>{const a=v,s=h,l=g(j("u-button"),w),y=g(j("u-loading-icon"),C),_=g(j("u-modal"),S);return u(),r(s,{style:x(t.themeColor())},{default:n((()=>[T.value?(u(),r(s,{key:0,class:"w-screen h-screen flex flex-col items-center"},{default:n((()=>[i(s,{class:"flex-1 flex flex-col items-center w-full pt-[100rpx]"},{default:n((()=>[i(a,{class:c(["iconfont text-2xl",2==T.value.status?"text-primary iconduigou":"iconzhifushibai text-red"])},null,8,["class"]),i(s,{class:"text-sm"},{default:n((()=>[p(m(2==T.value.status?d(o)("pay.paySuccess"):d(o)("pay.payFail")),1)])),_:1}),i(s,{class:"text-xl font-bold pt-[30rpx]"},{default:n((()=>[i(a,{class:"text-base"},{default:n((()=>[p(m(d(o)("currency")),1)])),_:1}),i(a,null,{default:n((()=>[p(m(d(b)(T.value.money)),1)])),_:1})])),_:1})])),_:1}),i(s,{class:"pb-[200rpx] w-[240rpx]"},{default:n((()=>[i(l,{type:"primary",text:2==T.value.status?d(o)("complete"):d(o)("close"),plain:!0,onClick:z},null,8,["text"])])),_:1})])),_:1})):f("v-if",!0),i(_,{show:E.value,showCancelButton:!0,confirmText:d(o)("pay.completePay"),cancelText:d(o)("pay.incompletePay"),onCancel:z,confirmColor:"var(--primary-color)"},{default:n((()=>[i(s,{class:"py-[20rpx]"},{default:n((()=>[i(y,{text:d(o)("pay.getting"),textSize:"16",mode:"circle",vertical:!0},null,8,["text"])])),_:1})])),_:1},8,["show","confirmText","cancelText"])])),_:1},8,["style"])}}});export{T as default};

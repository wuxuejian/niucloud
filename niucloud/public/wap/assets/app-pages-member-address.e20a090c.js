import{l as t,m as e,p as s,x as a,t as i,q as l,b7 as r,a_ as n,bh as o,g as u,h as d,o as c,c as h,w as p,b as f,C as b,O as m,Q as _,P as g,A as y,n as x,D as v,E as w,F as S,i as C,ae as k,f as z,d as T,r as X,j as A,bi as R,J as $,e as B,v as D,u as P,a as I,bj as j,bk as M}from"./index-f0b22e55.js";import{_ as Y,a as O}from"./u-tabbar.ad343165.js";import{_ as L}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as W}from"./u-icon.e73c62d6.js";import{_ as q}from"./u-button.6c9286f5.js";import{M as H}from"./mescroll-empty.7e260d1e.js";import"./u-safe-bottom.cdc7d17c.js";import"./u-loading-icon.c77adce6.js";import"./mescroll-i18n.ffa6f730.js";const N=L({name:"u-tabs",mixins:[e,s,{props:{duration:{type:Number,default:()=>t.tabs.duration},list:{type:Array,default:()=>t.tabs.list},lineColor:{type:String,default:()=>t.tabs.lineColor},activeStyle:{type:[String,Object],default:()=>t.tabs.activeStyle},inactiveStyle:{type:[String,Object],default:()=>t.tabs.inactiveStyle},lineWidth:{type:[String,Number],default:()=>t.tabs.lineWidth},lineHeight:{type:[String,Number],default:()=>t.tabs.lineHeight},lineBgSize:{type:String,default:()=>t.tabs.lineBgSize},itemStyle:{type:[String,Object],default:()=>t.tabs.itemStyle},scrollable:{type:Boolean,default:()=>t.tabs.scrollable},current:{type:[Number,String],default:()=>t.tabs.current},keyName:{type:String,default:()=>t.tabs.keyName}}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(t,e){t!==this.innerCurrent&&(this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return t=>{const e={},s=t===this.innerCurrent?a(this.activeStyle):a(this.inactiveStyle);return this.list[t].disabled&&(e.color="#c8c9cc"),i(s,e)}},propsBadge:()=>t.badge},async mounted(){this.init()},emits:["click","change"],methods:{addStyle:a,addUnit:l,setLineLeft(){const t=this.list[this.innerCurrent];if(!t)return;let e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0);const s=r(this.lineWidth);this.lineOffsetLeft=e+(t.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),10)},animation(t,e=0){},clickHandler(t,e){this.$emit("click",{...t,index:e},e),t.disabled||(this.innerCurrent=e,this.resize(),this.$emit("change",{...t,index:e},e))},init(){n().then((()=>{this.resize()}))},setScrollLeft(){const t=this.list[this.innerCurrent],e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),s=o().windowWidth;let a=e-(this.tabsRect.width-t.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;a=Math.min(a,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,a)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([t,e=[]])=>{this.tabsRect=t,this.scrollViewWidth=0,e.map(((t,e)=>{this.scrollViewWidth+=t.width,this.list[e].rect=t})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((t=>{this.queryRect("u-tabs__wrapper__scroll-view").then((e=>t(e)))}))},getAllItemRect(){return new Promise((t=>{const e=this.list.map(((t,e)=>this.queryRect(`u-tabs__wrapper__nav__item-${e}`,!0)));Promise.all(e).then((e=>t(e)))}))},queryRect(t,e){return new Promise((e=>{this.$uGetRect(`.${t}`).then((t=>{e(t)}))}))}}},[["render",function(t,e,s,a,i,l){const r=S,n=u(d("u-badge"),Y),o=C,z=k;return c(),h(o,{class:"u-tabs"},{default:p((()=>[f(o,{class:"u-tabs__wrapper"},{default:p((()=>[b(t.$slots,"left",{},void 0,!0),f(o,{class:"u-tabs__wrapper__scroll-view-wrapper"},{default:p((()=>[f(z,{"scroll-x":t.scrollable,"scroll-left":i.scrollLeft,"scroll-with-animation":"",class:"u-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"u-tabs__wrapper__scroll-view"},{default:p((()=>[f(o,{class:"u-tabs__wrapper__nav",ref:"u-tabs__wrapper__nav"},{default:p((()=>[(c(!0),m(_,null,g(t.list,((e,s)=>(c(),h(o,{class:y(["u-tabs__wrapper__nav__item",[`u-tabs__wrapper__nav__item-${s}`,e.disabled&&"u-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:t=>l.clickHandler(e,s),ref_for:!0,ref:`u-tabs__wrapper__nav__item-${s}`,style:x([l.addStyle(t.itemStyle),{flex:t.scrollable?"":1}])},{default:p((()=>[f(r,{class:y([[e.disabled&&"u-tabs__wrapper__nav__item__text--disabled"],"u-tabs__wrapper__nav__item__text"]),style:x([l.textStyle(s)])},{default:p((()=>[v(w(e[t.keyName]),1)])),_:2},1032,["class","style"]),f(n,{show:!(!e.badge||!(e.badge.show||e.badge.isDot||e.badge.value)),isDot:e.badge&&e.badge.isDot||l.propsBadge.isDot,value:e.badge&&e.badge.value||l.propsBadge.value,max:e.badge&&e.badge.max||l.propsBadge.max,type:e.badge&&e.badge.type||l.propsBadge.type,showZero:e.badge&&e.badge.showZero||l.propsBadge.showZero,bgColor:e.badge&&e.badge.bgColor||l.propsBadge.bgColor,color:e.badge&&e.badge.color||l.propsBadge.color,shape:e.badge&&e.badge.shape||l.propsBadge.shape,numberType:e.badge&&e.badge.numberType||l.propsBadge.numberType,inverted:e.badge&&e.badge.inverted||l.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),f(o,{class:"u-tabs__wrapper__nav__line",ref:"u-tabs__wrapper__nav__line",style:x([{width:l.addUnit(t.lineWidth),transform:`translate(${i.lineOffsetLeft}px)`,transitionDuration:`${i.firstTime?0:t.duration}ms`,height:l.addUnit(t.lineHeight),background:t.lineColor,backgroundSize:t.lineBgSize}])},null,8,["style"])])),_:1},512)])),_:1},8,["scroll-x","scroll-left"])])),_:1}),b(t.$slots,"right",{},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-caa7e19d"]]);const F={props:{show:{type:Boolean,default:()=>t.swipeActionItem.show},name:{type:[String,Number],default:()=>t.swipeActionItem.name},disabled:{type:Boolean,default:()=>t.swipeActionItem.disabled},autoClose:{type:Boolean,default:()=>t.swipeActionItem.autoClose},threshold:{type:Number,default:()=>t.swipeActionItem.threshold},options:{type:Array,default:()=>t.swipeActionItem.rightOptions},duration:{type:[String,Number],default:()=>t.swipeActionItem.duration}}};function U(t){return t.toString().indexOf("s")>=0?t:t>30?t+"ms":t+"s"}function V(t,e,s){e.getState(),s.selectAllComponents(".u-swipe-action-item__right__button"),e.requestAnimationFrame((function(){e.setStyle({transition:"none",transform:"translateX("+t+"px)","-webkit-transform":"translateX("+t+"px)"})}))}function Z(t,e){var s=t.getState();e.selectAllComponents(".u-swipe-action-item__right__button");var a=U(s.duration),i=-s.buttonsWidth;t.requestAnimationFrame((function(){t.setStyle({transition:"transform "+a,transform:"translateX("+i+"px)","-webkit-transform":"translateX("+i+"px)"})})),E("open",t,e)}function E(t,e,s){e.getState().status=t,s.callMethod("setState",t)}function G(t,e){var s=t.getState(),a=e.selectAllComponents(".u-swipe-action-item__right__button"),i=a.length,l=U(s.duration);t.requestAnimationFrame((function(){t.setStyle({transition:"transform "+l,transform:"translateX(0px)","-webkit-transform":"translateX(0px)"});for(var e=i-1;e>=0;e--)a[e].setStyle({transition:"transform "+l,transform:"translateX(0px)","-webkit-transform":"translateX(0px)"})})),E("close",t,e)}const J={touchstart:function(t,e){var s=t.instance.getState();if(!s.disabled){var a=t.touches;a&&a.length>1||(s.moving=!0,s.startX=a[0].pageX,s.startY=a[0].pageY,e.callMethod("closeOther"))}},touchmove:function(t,e){var s=t.instance,a=s.getState();if(!a.disabled&&a.moving){var i=t.touches,l=i[0].pageX,r=i[0].pageY,n=l-a.startX,o=r-a.startY,u=a.buttonsWidth;(Math.abs(n)>Math.abs(o)||Math.abs(n)>a.threshold)&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()),Math.abs(n)<Math.abs(o)||("open"===a.status?(n<0&&(n=0),n>u&&(n=u),V(-u+n,s,e)):(n>0&&(n=0),Math.abs(n)>u&&(n=-u),V(n,s,e)))}},touchend:function(t,e){var s=t.instance,a=s.getState();if(a.moving&&!a.disabled){var i=t.changedTouches?t.changedTouches[0]:{},l=i.pageX;i.pageY;var r=l-a.startX;if("open"===a.status){if(r<0)return;if(0===r)return G(s,e);Math.abs(r)<a.threshold?Z(s,e):G(s,e)}else{if(r>0)return;Math.abs(r)<a.threshold?G(s,e):Z(s,e)}}},sizeChange:function(t,e,s,a){var i=a.getState();if(i&&t){if(i.disabled=t.disabled,i.duration=t.duration,i.show=t.show,i.threshold=t.threshold,i.buttons=t.buttons,i.buttons)for(var l=i.buttons.length,r=0,n=t.buttons,o=0;o<l;o++)r+=n[o].width;i.buttonsWidth=r}},statusChange:function(t,e,s,a){var i=a.getState();i.disabled||("close"===t&&"open"===i.status?G(a,s):"open"===t&&"close"===i.status&&Z(a,s))}},Q=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxs"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxs=J}})},K={name:"u-swipe-action-item",emits:["click"],mixins:[e,s,{methods:{getTouchPoint:t=>t?t.touches&&t.touches[0]?{x:t.touches[0].pageX,y:t.touches[0].pageY}:t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:{x:t.clientX||0,y:t.clientY||0}:{x:0,y:0},resetTouchStatus(){this.direction="",this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0},touchStart(t){this.resetTouchStatus();const e=this.getTouchPoint(t);this.startX=e.x,this.startY=e.y},touchMove(t){const e=this.getTouchPoint(t);var s,a;this.deltaX=e.x-this.startX,this.deltaY=e.y-this.startY,this.offsetX=Math.abs(this.deltaX),this.offsetY=Math.abs(this.deltaY),this.direction=this.direction||(s=this.offsetX,a=this.offsetY,s>a&&s>10?"horizontal":a>s&&a>10?"vertical":"")}}},{methods:{closeHandler(){this.status="close"},setState(t){this.status=t},closeOther(){this.parent&&this.parent.closeOther(this)}}},F],data:()=>({size:{},parentData:{autoClose:!0},status:"close",sliderStyle:{}}),watch:{wxsInit(t,e){this.queryRect()}},computed:{wxsInit(){return[this.disabled,this.autoClose,this.threshold,this.options,this.duration]}},mounted(){this.init()},methods:{addUnit:l,getPx:r,init(){this.updateParentData(),n().then((()=>{this.queryRect()}))},updateParentData(){this.getParentData("u-swipe-action")},queryRect(){this.$uGetRect(".u-swipe-action-item__right__button",!0).then((t=>{this.size={buttons:t,show:this.show,disabled:this.disabled,threshold:this.threshold,duration:this.duration}}))},buttonClickHandler(t,e){this.$emit("click",{index:e,name:this.name})}}};Q(K);const tt=L(K,[["render",function(t,e,s,a,i,l){const r=u(d("u-icon"),W),n=S,o=C;return c(),h(o,{class:"u-swipe-action-item",ref:"u-swipe-action-item"},{default:p((()=>[f(o,{class:"u-swipe-action-item__right"},{default:p((()=>[b(t.$slots,"button",{},(()=>[(c(!0),m(_,null,g(t.options,((t,e)=>(c(),h(o,{key:e,class:"u-swipe-action-item__right__button",ref_for:!0,ref:`u-swipe-action-item__right__button-${e}`,style:x([{alignItems:t.style&&t.style.borderRadius?"center":"stretch"}]),onClick:s=>l.buttonClickHandler(t,e)},{default:p((()=>[f(o,{class:"u-swipe-action-item__right__button__wrapper",style:x([{backgroundColor:t.style&&t.style.backgroundColor?t.style.backgroundColor:"#C7C6CD",borderRadius:t.style&&t.style.borderRadius?t.style.borderRadius:"0",padding:t.style&&t.style.borderRadius?"0":"0 15px"},t.style])},{default:p((()=>[t.icon?(c(),h(r,{key:0,name:t.icon,color:t.style&&t.style.color?t.style.color:"#ffffff",size:t.iconSize?l.addUnit(t.iconSize):t.style&&t.style.fontSize?1.2*l.getPx(t.style.fontSize):17,customStyle:{marginRight:t.text?"2px":0}},null,8,["name","color","size","customStyle"])):z("v-if",!0),t.text?(c(),h(n,{key:1,class:"u-swipe-action-item__right__button__wrapper__text u-line-1",style:x([{color:t.style&&t.style.color?t.style.color:"#ffffff",fontSize:t.style&&t.style.fontSize?t.style.fontSize:"16px",lineHeight:t.style&&t.style.fontSize?t.style.fontSize:"16px"}])},{default:p((()=>[v(w(t.text),1)])),_:2},1032,["style"])):z("v-if",!0)])),_:2},1032,["style"])])),_:2},1032,["style","onClick"])))),128))]),!0)])),_:3}),f(o,{class:"u-swipe-action-item__content",onTouchstart:t.wxs.touchstart,onTouchmove:t.wxs.touchmove,onTouchend:t.wxs.touchend,status:i.status,"change:status":t.wxs.statusChange,size:i.size,"change:size":t.wxs.sizeChange},{default:p((()=>[b(t.$slots,"default",{},void 0,!0)])),_:3},8,["onTouchstart","onTouchmove","onTouchend","status","change:status","size","change:size"])])),_:3},512)}],["__scopeId","data-v-9e5550f1"]]);const et=L({name:"u-swipe-action",mixins:[e,s,{props:{autoClose:{type:Boolean,default:()=>t.swipeAction.autoClose}}}],data:()=>({}),provide(){return{swipeAction:this}},computed:{parentData(){return[this.autoClose]}},watch:{parentData(){this.children.length&&this.children.map((t=>{"function"==typeof t.updateParentData&&t.updateParentData()}))}},created(){this.children=[]},methods:{closeOther(t){this.autoClose&&this.children.map(((e,s)=>{t!==e&&e.closeHandler()}))}}},[["render",function(t,e,s,a,i,l){const r=C;return c(),h(r,{class:"u-swipe-action"},{default:p((()=>[b(t.$slots,"default")])),_:3})}]]),st=L(T({__name:"address",setup(t){const e=X(!0),s=X(0),a=X([{name:"快递地址",key:"address"},{name:"同城配送地址",key:"location_address"}]),i=X([]),l=X([]),r=X(""),n=X("");A((t=>{r.value=t.type||"",n.value=t.source||"",t.type&&(s.value="address"==t.type?0:1)})),R({}).then((({data:t})=>{const s=[],a=[];t.forEach((t=>{"address"==t.type?s.push(t):a.push(t)})),i.value=s,l.value=a,e.value=!1})).catch((()=>{e.value=!1}));const o=t=>{s.value=t.index},b=()=>{const t=`/app/pages/member/${a.value[s.value].key}_edit`;I({url:t,param:{type:a.value[s.value].key,source:n.value}})},T=t=>{const e=`/app/pages/member/${a.value[s.value].key}_edit`;I({url:e,param:{id:t,type:a.value[s.value].key,source:n.value}})},Y=X([{text:$("delete"),style:{backgroundColor:"#F56C6C"}}]),L=t=>{const e=uni.getStorageSync("selectAddressCallback");e&&(e.address_id=t.id,uni.setStorage({key:"selectAddressCallback",data:e,success(){I({url:e.back,mode:"redirectTo"})}}))},W=t=>{const e=s.value?l:i,a=e.value[t.index];M(a.id).then((()=>{e.value.splice(t.index,1)})).catch()};return(t,r)=>{const X=u(d("u-tabs"),N),A=C,R=S,I=u(d("u-swipe-action-item"),tt),M=u(d("u-swipe-action"),et),F=u(d("u-button"),q),U=u(d("u-tabbar"),O),V=k;return e.value?z("v-if",!0):(c(),h(A,{key:0,style:x(t.themeColor())},{default:p((()=>[n.value?z("v-if",!0):(c(),h(A,{key:0,class:"border-0 !border-b !border-[#eee] border-solid fixed top-0 left-0 right-0 z-99 bg-[#fff]"},{default:p((()=>[f(X,{list:a.value,onClick:o,current:s.value,itemStyle:"width:50%;height:88rpx;box-sizing: border-box;"},null,8,["list","current"])])),_:1})),f(V,{"scroll-y":"true",class:y({"pt-[88rpx]":!n.value})},{default:p((()=>[f(M,null,{default:p((()=>[B(f(A,{class:"p-[30rpx]"},{default:p((()=>[(c(!0),m(_,null,g(i.value,(t=>(c(),h(I,{options:Y.value,onClick:W},{default:p((()=>[f(A,{class:"border-0 !border-b !border-[#f5f5f5] border-solid pb-[30rpx] flex items-center"},{default:p((()=>[f(A,{class:"flex-1 line-feed",onClick:e=>L(t)},{default:p((()=>[f(A,{class:"font-bold my-[10rpx] text-sm line-feed"},{default:p((()=>[v(w(t.full_address),1)])),_:2},1024),f(A,{class:"text-sm flex items-center"},{default:p((()=>[f(A,null,{default:p((()=>[v(w(t.name),1)])),_:2},1024),f(R,{class:"text-[26rpx] text-gray-subtitle"},{default:p((()=>[v(w(P(j)(t.mobile)),1)])),_:2},1024),1==t.is_default?(c(),h(A,{key:0,class:"bg-primary text-white text-xs px-[10rpx] leading-none flex items-center h-[32rpx] ml-[10rpx] rounded min-w-[50rpx]"},{default:p((()=>[v(w(P($)("default")),1)])),_:1})):z("v-if",!0)])),_:2},1024)])),_:2},1032,["onClick"]),f(R,{class:"iconfont iconbianji shrink-0 text-[40rpx] p-[20rpx] pr-0",onClick:e=>T(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["options"])))),256)),i.value.length?z("v-if",!0):(c(),h(A,{key:0,class:"pt-[20vh]"},{default:p((()=>[f(H,{option:{tip:"暂无收货地址"}})])),_:1}))])),_:1},512),[[D,0==s.value]]),B(f(A,{class:"p-[30rpx]"},{default:p((()=>[(c(!0),m(_,null,g(l.value,(t=>(c(),h(I,{options:Y.value,onClick:W},{default:p((()=>[f(A,{class:"border-0 !border-b !border-[#f5f5f5] border-solid pb-[30rpx] flex items-center"},{default:p((()=>[f(A,{class:"flex-1",onClick:e=>L(t)},{default:p((()=>[f(A,{class:"font-bold my-[10rpx] text-sm line-feed"},{default:p((()=>[v(w(t.full_address),1)])),_:2},1024),f(A,{class:"text-sm flex items-center"},{default:p((()=>[f(A,null,{default:p((()=>[v(w(t.name),1)])),_:2},1024),f(R,{class:"text-[26rpx] text-gray-subtitle"},{default:p((()=>[v(w(P(j)(t.mobile)),1)])),_:2},1024),1==t.is_default?(c(),h(A,{key:0,class:"bg-primary text-white text-xs px-[10rpx] leading-none flex items-center h-[32rpx] ml-[10rpx] rounded min-w-[50rpx]"},{default:p((()=>[v(w(P($)("default")),1)])),_:1})):z("v-if",!0)])),_:2},1024)])),_:2},1032,["onClick"]),f(R,{class:"iconfont iconbianji shrink-0 text-[40rpx] p-[20rpx] pr-0",onClick:e=>T(t.id)},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["options"])))),256)),l.value.length?z("v-if",!0):(c(),h(A,{key:0,class:"pt-[20vh]"},{default:p((()=>[f(H,{option:{tip:"暂无收货地址"}})])),_:1}))])),_:1},512),[[D,1==s.value]])])),_:1}),f(U,{fixed:!0,safeAreaInsetBottom:!0,border:!1,zIndex:"99"},{default:p((()=>[f(A,{class:"p-[24rpx] pt-0 w-full"},{default:p((()=>[f(F,{type:"primary",shape:"circle",text:P($)("createAddress"),onClick:b},null,8,["text"])])),_:1})])),_:1})])),_:1},8,["class"])])),_:1},8,["style"]))}}}),[["__scopeId","data-v-8996f6f6"]]);export{st as default};

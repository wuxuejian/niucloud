import{_ as e}from"./u-loading-page.4c88d84e.js";import{B as a,C as t,D as r,q as o,t as l,i as s,j as i,w as n,k as d,p as u,m as c,G as p,Y as m,x as y,d as g,a6 as h,r as f,af as _,e as v,H as b,I as x,n as w,L as k,a9 as S,Q as C,S as E,R as $,y as I,T as L,ae as U,K as j,ag as B,a as T,b as R,a8 as F,l as H,v as z,J as O}from"./index-1dfccf80.js";import{_ as M}from"./u-button.9b26a552.js";import{_ as N}from"./u-icon.c25483bc.js";import{_ as P}from"./u-transition.7f35ba14.js";import{_ as A}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as Y}from"./u-popup.8d5bb746.js";import{p as q,g as D}from"./pay.e9ede3b1.js";import{w as G}from"./wechat.ead44fad.js";import"./u-loading-icon.421800ef.js";import"./u-safe-bottom.fc62d1ef.js";const J=A({name:"u-image",mixins:[t,r,{props:{src:{type:String,default:a.image.src},mode:{type:String,default:a.image.mode},width:{type:[String,Number],default:a.image.width},height:{type:[String,Number],default:a.image.height},shape:{type:String,default:a.image.shape},radius:{type:[String,Number],default:a.image.radius},lazyLoad:{type:Boolean,default:a.image.lazyLoad},showMenuByLongpress:{type:Boolean,default:a.image.showMenuByLongpress},loadingIcon:{type:String,default:a.image.loadingIcon},errorIcon:{type:String,default:a.image.errorIcon},showLoading:{type:Boolean,default:a.image.showLoading},showError:{type:Boolean,default:a.image.showError},fade:{type:Boolean,default:a.image.fade},webp:{type:Boolean,default:a.image.webp},duration:{type:[String,Number],default:a.image.duration},bgColor:{type:String,default:a.image.bgColor}}}],data(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{},show:!1}},watch:{src:{immediate:!0,handler(e){e?(this.isError=!1,this.loading=!0):this.isError=!0}}},computed:{wrapStyle(){let e={};return e.width=this.$u.addUnit(this.width),e.height=this.$u.addUnit(this.height),e.borderRadius="circle"==this.shape?"10000px":uni.$u.addUnit(this.radius),e.overflow=this.radius>0?"hidden":"visible",uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},mounted(){this.show=!0},emits:["click","error","load"],methods:{onClick(){this.$emit("click")},onErrorHandler(e){this.loading=!1,this.isError=!0,this.$emit("error",e)},onLoadHandler(e){this.loading=!1,this.isError=!1,this.$emit("load",e),this.removeBgColor()},removeBgColor(){this.backgroundStyle={backgroundColor:"transparent"}}}},[["render",function(e,a,t,r,g,h){const f=m,_=o(l("u-icon"),N),v=y,b=o(l("u-transition"),P);return s(),i(b,{mode:"fade",show:g.show,duration:e.fade?1e3:0},{default:n((()=>[d(v,{class:"u-image",onClick:h.onClick,style:u([h.wrapStyle,g.backgroundStyle])},{default:n((()=>[g.isError?c("v-if",!0):(s(),i(f,{key:0,src:e.src,mode:e.mode,onError:h.onErrorHandler,onLoad:h.onLoadHandler,"show-menu-by-longpress":e.showMenuByLongpress,"lazy-load":e.lazyLoad,class:"u-image__image",style:u({borderRadius:"circle"==e.shape?"10000px":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},null,8,["src","mode","onError","onLoad","show-menu-by-longpress","lazy-load","style"])),e.showLoading&&g.loading?(s(),i(v,{key:1,class:"u-image__loading",style:u({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),backgroundColor:this.bgColor,width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:n((()=>[p(e.$slots,"loading",{},(()=>[d(_,{name:e.loadingIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):c("v-if",!0),e.showError&&g.isError&&!g.loading?(s(),i(v,{key:2,class:"u-image__error",style:u({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:n((()=>[p(e.$slots,"error",{},(()=>[d(_,{name:e.errorIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):c("v-if",!0)])),_:3},8,["onClick","style"])])),_:3},8,["show","duration"])}],["__scopeId","data-v-466b6710"]]),K=A(g({__name:"pay",emits:["close"],setup(e,{expose:a,emit:t}){h()&&G.init();const r=f(!1),u=f(!1),p=f(null),m=f(""),g=()=>{var e,a;uni.$u.test.isEmpty(m.value)?L({title:k("pay.notHavePayType"),icon:"none"}):u.value||(u.value=!0,q({trade_type:null==(e=p.value)?void 0:e.trade_type,trade_id:null==(a=p.value)?void 0:a.trade_id,type:m.value}).then((e=>{var a,t,r,o,l,s;switch(m.value){case"wechatpay":h()?(e.data.timestamp=e.data.timeStamp,delete e.data.timeStamp,G.pay({...e.data,success:()=>{j()},cancel:()=>{u.value=!1}})):(uni.setStorageSync("paymenting",{trade_type:null==(a=p.value)?void 0:a.trade_type,trade_id:null==(t=p.value)?void 0:t.trade_id}),location.href=e.data.h5_url);break;case"alipay":h()?v({url:"/app/pages/pay/browser",param:{trade_type:null==(r=p.value)?void 0:r.trade_type,trade_id:null==(o=p.value)?void 0:o.trade_id,alipay:encodeURIComponent(e.data.url)},mode:"redirectTo"}):(uni.setStorageSync("paymenting",{trade_type:null==(l=p.value)?void 0:l.trade_type,trade_id:null==(s=p.value)?void 0:s.trade_id}),location.href=e.data.url);break;default:j()}})).catch((()=>{u.value=!1})))};_("checkIsReturnAfterPayment",(()=>{const e=uni.getStorageSync("paymenting");uni.getStorageSync("paymenting")&&v({url:"/app/pages/pay/result",param:{trade_type:e.trade_type,trade_id:e.trade_id},mode:"redirectTo",success(){uni.removeStorageSync("paymenting")}})}));const j=()=>{var e,a;v({url:"/app/pages/pay/result",param:{trade_type:null==(e=p.value)?void 0:e.trade_type,trade_id:null==(a=p.value)?void 0:a.trade_id},mode:"redirectTo"})},B=()=>{uni.removeStorageSync("paymenting"),r.value=!1,t("close")};return a({open:(e,a,t="")=>{uni.setStorageSync("payReturn",encodeURIComponent(t)),D(e,a).then((e=>{let{data:a}=e;p.value=a,uni.$u.test.isEmpty(a)?L({title:k("pay.notObtainedInfo"),icon:"none"}):0!=a.money?(m.value=a.pay_type_list[0]?a.pay_type_list[0].key:"",r.value=!0):j()})).catch((()=>{}))}}),(e,a)=>{const t=y,h=o(l("u-image"),J),f=o(l("u-icon"),N),_=U,v=o(l("u-button"),M),L=o(l("u-popup"),Y);return s(),i(L,{show:r.value,round:10,onClose:B,closeable:!0,bgColor:"#fff",zIndex:"10081",closeOnClickOverlay:!1},{default:n((()=>[p.value?(s(),i(t,{key:0,class:"flex flex-col h-[75vh]"},{default:n((()=>[d(t,{class:"head"},{default:n((()=>[d(t,{class:"text-center py-[26rpx]"},{default:n((()=>[b(x(w(k)("pay.payTitle")),1)])),_:1}),d(t,{class:"flex items-end justify-center w-full text-xl font-bold py-[20rpx]"},{default:n((()=>[d(t,{class:"text-base mr-[4rpx]"},{default:n((()=>[b(x(w(k)("currency")),1)])),_:1}),b(" "+x(w(S)(p.value.money)),1)])),_:1})])),_:1}),d(_,{"scroll-y":"true",class:"flex-1 pt-[20rpx]"},{default:n((()=>[d(t,{class:"flex text-sm px-[30rpx] py-[20rpx]"},{default:n((()=>[d(t,{class:"text-gray-500"},{default:n((()=>[b(x(w(k)("pay.orderInfo")),1)])),_:1}),d(t,{class:"text-right flex-1 pl-[30rpx] truncate"},{default:n((()=>[b(x(p.value.body),1)])),_:1})])),_:1}),d(t,{class:"mx-[30rpx] py-[10rpx] px-[30rpx] bg-white rounded-md bg-page"},{default:n((()=>[p.value.pay_type_list.length?(s(!0),C(E,{key:0},$(p.value.pay_type_list,((e,a)=>(s(),i(t,{class:"pay-item py-[18rpx] flex items-center border-0 border-b border-solid border-[#eee]",key:a,onClick:a=>m.value=e.key},{default:n((()=>[d(h,{src:w(I)(e.icon),width:"50rpx",height:"50rpx"},null,8,["src"]),d(t,{class:"flex-1 px-[20rpx] text-sm font-bold"},{default:n((()=>[b(x(e.name),1)])),_:2},1024),e.key==m.value?(s(),i(f,{key:0,name:"checkbox-mark",color:"var(--primary-color)"})):c("v-if",!0)])),_:2},1032,["onClick"])))),128)):(s(),i(t,{key:1,class:"py-[20rpx] text-center text-sm text-gray-subtitle"},{default:n((()=>[b(x(w(k)("pay.notHavePayType")),1)])),_:1}))])),_:1})])),_:1}),d(t,{class:"p-[30rpx]"},{default:n((()=>[d(v,{type:"primary",loading:u.value,text:w(k)("pay.confirmPay"),shape:"circle",onClick:g},null,8,["loading","text"])])),_:1})])),_:1})):c("v-if",!0)])),_:1},8,["show"])}}}),[["__scopeId","data-v-b5c21611"]]),Q=A(g({__name:"balance",setup(a){const t=j(),r=B(),p=T({is_auto_transfer:0,is_auto_verify:0,is_open:0,min:0,rate:0,transfer_type:[]}),g=f(!0);R((()=>{F().then((e=>{for(let a in e.data)p[a]=e.data[a];g.value=!1}))}));const h=()=>{uni.setStorageSync("cashOutAccountType","money"),v({url:"/app/pages/member/apply_cash_out"})};return(a,f)=>{const _=o(l("u-loading-page"),e),C=y,E=m,$=O,L=o(l("u-button"),M),U=o(l("pay"),K);return s(),i(C,{style:u(a.themeColor())},{default:n((()=>[d(_,{loading:g.value,loadingText:""},null,8,["loading"]),H(d(C,{class:"account-info-wrap"},{default:n((()=>[d(C,{class:"account-info-head",style:u({background:"url("+w(I)("static/resource/images/member/balance_bg.png")+") no-repeat 95% 30% / auto 250rpx, linear-gradient(314deg, #FE7849 0%, #FF1959 100%)"})},{default:n((()=>[d(C,{class:"name"},{default:n((()=>[b(x(w(k)("balanceInfo")),1)])),_:1}),d(C,{class:"content"},{default:n((()=>[d(C,{class:"money"},{default:n((()=>[b(x(w(t).info?w(S)((parseFloat(w(t).info.balance)+parseFloat(w(t).info.money)).toString()):"0.00"),1)])),_:1}),d(C,{class:"text"},{default:n((()=>[b(x(w(k)("accountBalance")),1)])),_:1}),d(C,{class:"money-wrap"},{default:n((()=>[d(C,{class:"money-item",onClick:f[0]||(f[0]=e=>w(v)({url:"/app/pages/member/detailed_account",param:{type:"balance"}}))},{default:n((()=>[d(C,{class:"money"},{default:n((()=>{var e;return[b(x(w(S)(null==(e=w(t).info)?void 0:e.balance)||"0.00"),1)]})),_:1}),d(C,{class:"text leading-none"},{default:n((()=>[b(x(w(k)("balance")),1)])),_:1})])),_:1}),d(C,{class:"money-item",onClick:f[1]||(f[1]=e=>w(v)({url:"/app/pages/member/detailed_account",param:{type:"money"}}))},{default:n((()=>[d(C,{class:"money"},{default:n((()=>{var e;return[b(x(w(S)(null==(e=w(t).info)?void 0:e.money)||"0.00"),1)]})),_:1}),d(C,{class:"text leading-none"},{default:n((()=>[b(x(w(k)("money")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),d(C,{class:"account-info-btn"},{default:n((()=>[w(r).siteAddons.includes("recharge")?(s(),i(L,{key:0,type:"primary",shape:"circle",class:"btn",customStyle:{backgroundColor:"#FE4E50",color:"#fff",borderColor:"#FE4E50",width:"calc(100vw - 64rpx)"},onClick:f[2]||(f[2]=e=>w(v)({url:"/addon/recharge/pages/recharge"}))},{default:n((()=>[d(E,{class:"max-w-[36rpx] max-h-[36rpx] mr-1",src:w(I)("static/resource/images/member/reset.png")},null,8,["src"]),d($,null,{default:n((()=>[b(x(w(k)("recharge")),1)])),_:1})])),_:1},8,["customStyle"])):c("v-if",!0),1==p.is_open?(s(),i(L,{key:1,type:"primary",plain:!0,shape:"circle",class:"btn",customStyle:{backgroundColor:"#fff",color:"#FE4E50",borderColor:"#FE4E50",width:"calc(100vw - 64rpx)"},onClick:h},{default:n((()=>[d(E,{class:"max-w-[36rpx] max-h-[36rpx] mr-1",src:w(I)("static/resource/images/member/withdraw_deposit.png")},null,8,["src"]),d($,null,{default:n((()=>[b(x(w(k)("cashOut")),1)])),_:1})])),_:1},8,["customStyle"])):c("v-if",!0)])),_:1}),d(U,{ref:"payRef",onClose:f[3]||(f[3]=e=>a.rechargeLoading=!1)},null,512)])),_:1},512),[[z,!g.value]])])),_:1},8,["style"])}}}),[["__scopeId","data-v-8083664e"]]);export{Q as default};

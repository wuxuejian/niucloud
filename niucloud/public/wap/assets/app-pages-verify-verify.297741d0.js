import{d as e,r as t,j as a,ai as l,R as s,S as r,a4 as p,a5 as i,a as c,o as x,c as n,w as u,T as o,b as d,u as f,E as m,V as v,U as g,F as _,f as h,n as y,_ as b,G as j,i as w,g as k,h as T,l as C,B as F}from"./index-d5155418.js";import{_ as z}from"./u-loading-page.76453af1.js";import{g as B,a as E,v as I}from"./verify.6163e59b.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.15e9cfe2.js";import"./u-transition.b7ca8cae.js";const S=R(e({__name:"verify",setup(e){const R=t(!0),S=t("");a((e=>{if(e.code&&(S.value=e.code),e.scene){let t=decodeURIComponent(e.scene).split("&");t.length&&t.forEach((e=>{-1!=e.indexOf("code")&&(S.value=e.split("-")[1])}))}})),l((()=>{s()&&(U(),L())}));const U=()=>{B().then((e=>{e.data?R.value=!1:(r({title:"非核销员无此权限",icon:"none"}),setTimeout((()=>{p().length>1?i({delta:1}):c({url:"/app/pages/member/index",mode:"reLaunch"})}),1e3))}))},G=t({}),L=()=>{R.value=!0,E(S.value).then((e=>{G.value=e.data,R.value=!1})).catch((()=>{setTimeout((()=>{R.value=!1,c({url:"/app/pages/verify/index",param:{},mode:"redirectTo"})}),1e3)}))};let O=!1;const V=()=>{if(O)return!1;O=!0,I(S.value).then((e=>{r({title:"核销成功",icon:"none"}),setTimeout((()=>{O=!1,c({url:"/app/pages/verify/index",param:{},mode:"redirectTo"})}),1e3)})).catch((()=>{O=!1}))};return(e,t)=>{const a=b,l=j,s=w,r=k(T("u-loading-page"),z);return x(),n(s,{style:y(e.themeColor()),class:"bg-[#f8f8f8] min-h-[100vh] overflow-hidden"},{default:u((()=>[!R.value&&G.value&&G.value.value?(x(),o(v,{key:0},[d(s,{class:"w-full bg-[#fff] flex justify-center"},{default:u((()=>[d(s,{class:"text-[var(--primary-color)] absolute top-[40rpx] right-[30rpx] flex items-center",onClick:t[0]||(t[0]=e=>f(c)({url:"/app/pages/verify/record"}))},{default:u((()=>[d(a,{class:"w-[26rpx] h-[28rpx]",src:f(C)("static/resource/images/verify/history.png")},null,8,["src"]),d(l,{class:"text-[26rpx] ml-[10rpx]"},{default:u((()=>[m("核销记录")])),_:1})])),_:1}),d(s,{class:"flex pt-[120rpx] pb-[30rpx] items-center"},{default:u((()=>[d(s,{class:"flex justify-center items-center flex-col pr-[30rpx] w-[130rpx]"},{default:u((()=>[d(a,{class:"w-[100rpx] h-[100rpx]",src:f(C)("static/resource/images/verify/yanzhenghexiaoma.png")},null,8,["src"]),d(s,{class:"text-[26rpx] mt-[12rpx] h-[36rpx] leading-[36rpx]"},{default:u((()=>[m("验证核销码")])),_:1})])),_:1}),d(a,{class:"w-[74rpx] h-[12rpx] mb-[50rpx]",src:f(C)("static/resource/images/verify/youjiantou.png")},null,8,["src"]),d(s,{class:"flex justify-center items-center flex-col pl-[30rpx] w-[130rpx]"},{default:u((()=>[d(a,{class:"w-[100rpx] h-[100rpx]",src:f(C)("static/resource/images/verify/hexiao.png")},null,8,["src"]),d(s,{class:"text-[26rpx] mt-[12rpx] h-[36rpx] leading-[36rpx]"},{default:u((()=>[m("确定核销")])),_:1})])),_:1})])),_:1})])),_:1}),d(s,{class:"card-template mt-[20rpx] sidebar-marign"},{default:u((()=>[(x(!0),o(v,null,g(G.value.value.list,((e,t)=>(x(),n(s,{class:F(["flex",{"mb-[20rpx]":G.value.value.list.length-1!=t}]),key:t},{default:u((()=>[e.cover?(x(),n(a,{key:0,class:"w-[150rpx] h-[150rpx] rounded-[8rpx]",mode:"aspectFill",src:f(C)(e.cover)},null,8,["src"])):(x(),n(a,{key:1,class:"w-[150rpx] h-[150rpx] rounded-[8rpx]",mode:"aspectFill",src:f(C)("addon/tourism/tourism/member/hotel.png")},null,8,["src"])),d(s,{class:"flex flex-col flex-1 ml-[20rpx] py-[4rpx]"},{default:u((()=>[d(s,{class:"leading-[1.3] multi-hidden"},{default:u((()=>[m(_(e.name),1)])),_:2},1024),d(s,{class:"self-end text-[#626779] text-[28rpx] mt-[10rpx]"},{default:u((()=>[m("x1")])),_:1})])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1}),d(s,{class:"card-template mt-[20rpx] sidebar-marign"},{default:u((()=>[d(s,{class:"text-[32rpx] font-500 leading-[1.3]"},{default:u((()=>[m("核销信息")])),_:1}),d(s,{class:"flex pt-[30rpx] items-center justify-between min-h-[36rpx]"},{default:u((()=>[d(l,{class:"text-[26rpx] text-[#626779]"},{default:u((()=>[m("核销类型")])),_:1}),d(s,{class:"text-[26rpx] text-[#333333]"},{default:u((()=>[m(_(G.value.type_name),1)])),_:1})])),_:1}),(x(!0),o(v,null,g(G.value.value.content.fixed,((e,t)=>(x(),n(s,{class:"flex pt-[20rpx] items-center justify-between min-h-[36rpx]"},{default:u((()=>[d(l,{class:"text-[26rpx] text-[#626779]"},{default:u((()=>[m(_(e.title),1)])),_:2},1024),d(s,{class:"text-[26rpx] text-[#333333]"},{default:u((()=>[m(_(e.value),1)])),_:2},1024)])),_:2},1024)))),256))])),_:1}),(x(!0),o(v,null,g(G.value.value.content.diy,((e,t)=>(x(),n(s,{key:t,class:"card-template mt-[20rpx] sidebar-marign"},{default:u((()=>[d(s,{class:"text-[32rpx] font-500 leading-[1.3]"},{default:u((()=>[m(_(e.title),1)])),_:2},1024),(x(!0),o(v,null,g(e.list,((e,t)=>(x(),n(s,{class:F(["flex items-center justify-between min-h-[36rpx]",{"pt-[30rpx]":0==t,"pt-[20rpx]":0!=t}]),key:t},{default:u((()=>[d(l,{class:"text-[26rpx] text-[#626779]"},{default:u((()=>[m(_(e.title),1)])),_:2},1024),d(l,{class:"text-[26rpx] text-[#333333]"},{default:u((()=>[m(_(e.value),1)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128)),d(l,{class:"min-w-[630rpx] fixed bottom-[60rpx] confirmBtn text-[#fff] flex items-center justify-center !text-[32rpx] rounded-[50rpx] h-[88rpx] ml-[60rpx] mr-[60rpx]",onClick:V},{default:u((()=>[m("确定")])),_:1})],64)):h("v-if",!0),d(r,{loading:R.value,"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-c3dc989e"]]);export{S as default};

import{d as a,r as e,u as l,a as o,c as t,o as r,b as g,g as s,A as p,f as i,s as u,h as n,i as d,j as m,w as v,k as b,l as c,v as f,m as h,n as S,p as y,q as x,t as C,x as j,y as _}from"./index-1dfccf80.js";import{_ as B}from"./u-loading-page.4c88d84e.js";import{u as k}from"./useShare.a7c4792d.js";import{d as $,f as w}from"./index.190dc315.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.421800ef.js";import"./u-transition.7f35ba14.js";import"./wechat.ead44fad.js";import"./u-icon.c25483bc.js";import"./u-avatar.69930c47.js";import"./u-popup.8d5bb746.js";import"./u-safe-bottom.fc62d1ef.js";import"./u-parse.7a99bf9e.js";import"./u-tabbar.067e12fb.js";const M=E(a({__name:"diy",setup(a){const{setShare:E,onShareAppMessage:M,onShareTimeline:T}=k();M(),T();const A=e(!0),D=l(),R=e(0);let U=e(!1);const G=o({pageMode:"diy",title:"",global:{},value:[]}),H=t((()=>"decorate"==D.mode?D:G)),J=e(0),N=e(""),O=e("");r((a=>{D.mode=a.mode||"","decorate"==D.mode&&(A.value=!1),J.value=a.id||"",N.value=a.name||"",O.value=a.template||""})),g((()=>{"decorate"==D.mode?D.init():s({id:J.value,name:N.value,template:O.value}).then((a=>{if(a.data.value){let e=a.data;G.pageMode=e.mode,G.title=e.title;let l=JSON.parse(e.value);G.global=l.global,G.value=l.value,G.value.forEach(((a,e)=>{a.pageStyle="",a.pageStartBgColor&&(a.pageStartBgColor&&a.pageEndBgColor?a.pageStyle+=`background:linear-gradient(${a.pageGradientAngle},${a.pageStartBgColor},${a.pageEndBgColor});`:a.pageStyle+="background-color:"+a.pageStartBgColor+";"),a.margin&&(a.pageStyle+="padding-top:"+2*a.margin.top+"rpx;",a.pageStyle+="padding-bottom:"+2*a.margin.bottom+"rpx;",a.pageStyle+="padding-right:"+2*a.margin.both+"rpx;",a.pageStyle+="padding-left:"+2*a.margin.both+"rpx;")})),U.value=G.value.some((a=>a&&a.position&&"top_fixed"==a.position)),p({title:G.title})}let e=a.data.share?JSON.parse(a.data.share):null;E(e),A.value=!1}))}));const q=t((()=>{var a="";return H.value.global.pageStartBgColor&&H.value.global.pageEndBgColor?a+=`background:linear-gradient(${H.value.global.pageGradientAngle},${H.value.global.pageStartBgColor},${H.value.global.pageEndBgColor});`:a+="background-color:"+H.value.global.pageStartBgColor+";",a+="min-height:calc(100vh - 50px);",H.value.global.bgUrl&&(a+=`background-image:url('${_(H.value.global.bgUrl)}');`),H.value.global.bgHeightScale&&(a+=`background-size: 100% ${H.value.global.bgHeightScale}%;`),a}));return i((()=>{R.value++,u()})),n((a=>{D.scrollTop=a.scrollTop})),(a,e)=>{const l=x(C("u-loading-page"),B),o=j;return d(),m(o,{style:y(a.themeColor())},{default:v((()=>[b(l,{loading:A.value,loadingText:"","bg-color":"#f7f7f7"},null,8,["loading"]),c(b(o,null,{default:v((()=>[h(" 自定义模板渲染 "),"fixed"!=S(H).pageMode?(d(),m(o,{key:0,class:"diy-template-wrap bg-index",style:y(S(q))},{default:v((()=>[b($,{data:S(H),pullDownRefreshCount:R.value},null,8,["data","pullDownRefreshCount"])])),_:1},8,["style"])):h("v-if",!0),h(" 固定模板渲染 "),"fixed"==S(H).pageMode?(d(),m(o,{key:1,class:"fixed-template-wrap"},{default:v((()=>[b(w,{data:S(H),pullDownRefreshCount:R.value},null,8,["data","pullDownRefreshCount"])])),_:1})):h("v-if",!0)])),_:1},512),[[f,!A.value]])])),_:1},8,["style"])}}}),[["__scopeId","data-v-de00178e"]]);export{M as default};

import{G as e,_ as a,$ as t,a0 as i,H as l,a1 as r,a2 as n,a3 as s,a4 as o,a5 as c}from"./index-f0b22e55.js";import{w as h}from"./wechat.48f9853d.js";const m=()=>{var m={title:"",link:""},p={};const u=()=>{c()&&h.share(m)},w=async(s={})=>{let o=e();if(uni.getStorageSync("isWatchShare")||(a((()=>o.info),((e,a)=>{e&&a&&e.member_id!=a.member_id&&w(s)})),uni.setStorageSync("isWatchShare",!0)),await(async()=>{c()&&await h.init()})(),s&&s.wechat&&s.weapp){let e=t().params;o.info&&(e.mid=o.info.member_id);let a=[];for(let t in e)a.push(t+"="+e[t]);let n=location.origin+location.pathname+(a.length>0?"?"+a.join("&"):"");m={title:s.wechat.title||"",link:s.wechat.link||n,desc:s.wechat.desc||"",imgUrl:s.wechat.url?i(s.wechat.url):""};const c=l((()=>o.info));""==m.link&&(m.link=location.href+"?mid="+c.value.member_id),u(),p={title:s.weapp.title||"",query:s.weapp.path||"/"+r()+(a.length>0?"?"+a.join("&"):""),imageUrl:s.weapp.url?i(s.weapp.url):""}}else n({route:"/"+r(),params:JSON.stringify(t().params)}).then((e=>{let a=e.data,t=a.wechat;if(t){let e=location.origin+location.pathname+(a.query?"?"+a.query:"");m={link:e,title:t.title,desc:t.desc,imgUrl:t.url?i(t.url):""}}u();let l=a.weapp;l&&(p={query:a.url,title:l.title,imageUrl:l.url?i(l.url):""})}))};return{setShare:w,onShareAppMessage:(e={})=>{s((()=>({...p,...e})))},onShareTimeline:(e={})=>{o((()=>({...p,...e})))}}};export{m as u};

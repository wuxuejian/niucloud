import{d as a,r as e,u as l,a as o,c as t,o as r,b as g,g as p,e as s,f as u,s as n,h as i,i as d,j as m,w as v,k as b,l as c,v as f,m as h,n as S,p as x,q as y,t as C,x as j,y as _}from"./index-1dfccf80.js";import{_ as B}from"./u-loading-page.4c88d84e.js";import{u as k}from"./useShare.a7c4792d.js";import{d as $,f as w}from"./index.190dc315.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.421800ef.js";import"./u-transition.7f35ba14.js";import"./wechat.ead44fad.js";import"./u-icon.c25483bc.js";import"./u-avatar.69930c47.js";import"./u-popup.8d5bb746.js";import"./u-safe-bottom.fc62d1ef.js";import"./u-parse.7a99bf9e.js";import"./u-tabbar.067e12fb.js";const E=D(a({__name:"index",setup(a){const{setShare:D,onShareAppMessage:E,onShareTimeline:M}=k();D(),E(),M();const T=e(!0),R=l(),A=e(0);let I=e(!1);const U=e(0),G=e("DIY_INDEX"),H=e(""),N=o({pageMode:"diy",title:"",global:{},value:[]}),X=t((()=>"decorate"==R.mode?R:N));r((a=>{R.mode=a.mode||"","decorate"==R.mode&&(T.value=!1),U.value=a.id||"",H.value=a.template||""})),g((()=>{"decorate"==R.mode?R.init():p({id:U.value,name:G.value,template:H.value}).then((a=>{let e=a.data;if(e.value){N.pageMode=e.mode,N.title=e.title;let a=JSON.parse(e.value);N.global=a.global,N.value=a.value,N.value.forEach(((a,e)=>{a.pageStyle="",a.pageStartBgColor&&(a.pageStartBgColor&&a.pageEndBgColor?a.pageStyle+=`background:linear-gradient(${a.pageGradientAngle},${a.pageStartBgColor},${a.pageEndBgColor});`:a.pageStyle+="background-color:"+a.pageStartBgColor+";"),a.margin&&(a.pageStyle+="padding-top:"+2*a.margin.top+"rpx;",a.pageStyle+="padding-bottom:"+2*a.margin.bottom+"rpx;",a.pageStyle+="padding-right:"+2*a.margin.both+"rpx;",a.pageStyle+="padding-left:"+2*a.margin.both+"rpx;")})),I.value=N.value.some((a=>a&&a.position&&"top_fixed"==a.position))}else e.page&&s({url:e.page,mode:"reLaunch"});T.value=!1}))}));const Y=t((()=>{var a="";return X.value.global.pageStartBgColor&&X.value.global.pageEndBgColor?a+=`background:linear-gradient(${X.value.global.pageGradientAngle},${X.value.global.pageStartBgColor},${X.value.global.pageEndBgColor});`:a+="background-color:"+X.value.global.pageStartBgColor+";",a+="min-height:calc(100vh - 50px);",X.value.global.bgUrl&&(a+=`background-image:url('${_(X.value.global.bgUrl)}');`),X.value.global.bgHeightScale&&(a+=`background-size: 100% ${X.value.global.bgHeightScale}%;`),a}));return u((()=>{A.value++,n()})),i((a=>{R.scrollTop=a.scrollTop})),(a,e)=>{const l=y(C("u-loading-page"),B),o=j;return d(),m(o,{style:x(a.themeColor())},{default:v((()=>[b(l,{loading:T.value,loadingText:"","bg-color":"#f7f7f7"},null,8,["loading"]),c(b(o,null,{default:v((()=>[h(" 自定义模板渲染 "),"fixed"!=S(X).pageMode?(d(),m(o,{key:0,class:"diy-template-wrap bg-index",style:x(S(Y))},{default:v((()=>[b($,{data:S(X),pullDownRefreshCount:A.value},null,8,["data","pullDownRefreshCount"])])),_:1},8,["style"])):h("v-if",!0),h(" 固定模板渲染 "),"fixed"==S(X).pageMode?(d(),m(o,{key:1,class:"fixed-template-wrap"},{default:v((()=>[b(w,{data:S(X),pullDownRefreshCount:A.value},null,8,["data","pullDownRefreshCount"])])),_:1})):h("v-if",!0)])),_:1},512),[[f,!T.value]])])),_:1},8,["style"])}}}),[["__scopeId","data-v-5c9d29b3"]]);export{E as default};

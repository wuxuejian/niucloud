import{_ as e}from"./u-input.68cc217f.js";import{d as a,r as l,I as t,bl as r,_ as i,bm as s,g as d,h as o,o as c,c as u,w as n,b as p,D as m,A as v,E as f,f as y,e as _,O as b,Q as h,P as x,v as g,i as k,ae as C,j,bn as V,H as P,u as w,n as A,bo as $,bp as E,a as U,J as q}from"./index-f0b22e55.js";import{_ as I,a as T}from"./u-form.64047760.js";import{_ as M}from"./u-switch.de63c925.js";import{_ as O}from"./u-button.6c9286f5.js";import{_ as R}from"./u-popup.d2722f83.js";import"./u-icon.e73c62d6.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-line.3e9a753b.js";import"./u-loading-icon.c77adce6.js";import"./u-transition.95f24654.js";import"./u-safe-bottom.cdc7d17c.js";const z=a({__name:"area-select",props:{areaId:{type:Number,default:0}},emits:["complete"],setup(e,{expose:a,emit:j}){const V=e,P=l(!1),w=t({province:[],city:[],district:[]}),A=l("province"),$=t({province:null,city:null,district:null});r(0).then((({data:e})=>{w.province=e})).catch(),i((()=>V.areaId),((e,a)=>{e&&!a&&s(e).then((({data:e})=>{e.province&&($.province=e.province),e.city&&($.city=e.city),e.district&&($.district=e.district)})).catch()})),i((()=>$.province),(()=>{r($.province.id).then((({data:e})=>{if(w.city=e,A.value="city",$.city){let a=!1;for(let l=0;l<e.length;l++)if($.city.id==e[l].id){a=!0;break}a||($.city=null)}})).catch()}),{deep:!0}),i((()=>$.city),(e=>{e?r($.city.id).then((({data:e})=>{if(w.district=e,A.value="district",$.district){let a=!1;for(let l=0;l<e.length;l++)if($.district.id==e[l].id){a=!0;break}a||($.district=null)}})).catch():(w.district=[],$.district=null)}),{deep:!0}),i((()=>$.district),(e=>{e&&(A.value="district",j("complete",$),P.value=!1)}),{deep:!0});return a({open:()=>{P.value=!0}}),(e,a)=>{const l=k,t=C,r=d(o("u-popup"),R);return c(),u(r,{show:P.value,onClose:a[3]||(a[3]=e=>P.value=!1),mode:"bottom",round:10,closeable:!0},{default:n((()=>[p(l,{class:"text-center p-[30rpx]"},{default:n((()=>[m("请选择地区")])),_:1}),p(l,{class:"flex p-[30rpx] text-sm font-semibold"},{default:n((()=>[w.province.length?(c(),u(l,{key:0,class:v(["flex-1",{"text-[var(--primary-color)]":"province"==A.value}]),onClick:a[0]||(a[0]=e=>A.value="province")},{default:n((()=>[$.province?(c(),u(l,{key:0},{default:n((()=>[m(f($.province.name),1)])),_:1})):(c(),u(l,{key:1},{default:n((()=>[m("请选择")])),_:1}))])),_:1},8,["class"])):y("v-if",!0),w.city.length?(c(),u(l,{key:1,class:v(["flex-1",{"text-[var(--primary-color)]":"city"==A.value}]),onClick:a[1]||(a[1]=e=>A.value="city")},{default:n((()=>[$.city?(c(),u(l,{key:0},{default:n((()=>[m(f($.city.name),1)])),_:1})):(c(),u(l,{key:1},{default:n((()=>[m("请选择")])),_:1}))])),_:1},8,["class"])):y("v-if",!0),w.district.length?(c(),u(l,{key:2,class:v(["flex-1",{"text-[var(--primary-color)]":"district"==A.value}]),onClick:a[2]||(a[2]=e=>A.value="district")},{default:n((()=>[$.district?(c(),u(l,{key:0},{default:n((()=>[m(f($.district.name),1)])),_:1})):(c(),u(l,{key:1},{default:n((()=>[m("请选择")])),_:1}))])),_:1},8,["class"])):y("v-if",!0)])),_:1}),p(t,{"scroll-y":"true",class:"h-[50vh]"},{default:n((()=>[p(l,{class:"flex p-[30rpx] pt-0 text-sm"},{default:n((()=>[w.province.length?_((c(),u(l,{key:0},{default:n((()=>[(c(!0),b(h,null,x(w.province,(e=>(c(),u(l,{class:v(["leading-loose",{"text-[var(--primary-color)]":$.province&&$.province.id==e.id}]),onClick:a=>$.province=e},{default:n((()=>[m(f(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1},512)),[[g,"province"==A.value]]):y("v-if",!0),w.city.length?_((c(),u(l,{key:1},{default:n((()=>[(c(!0),b(h,null,x(w.city,(e=>(c(),u(l,{class:v(["leading-loose",{"text-[var(--primary-color)]":$.city&&$.city.id==e.id}]),onClick:a=>$.city=e},{default:n((()=>[m(f(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1},512)),[[g,"city"==A.value]]):y("v-if",!0),w.district.length?_((c(),u(l,{key:2},{default:n((()=>[(c(!0),b(h,null,x(w.district,(e=>(c(),u(l,{class:v(["leading-loose",{"text-[var(--primary-color)]":$.district&&$.district.id==e.id}]),onClick:a=>$.district=e},{default:n((()=>[m(f(e.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1},512)),[[g,"district"==A.value]]):y("v-if",!0)])),_:1})])),_:1})])),_:1},8,["show"])}}}),D=a({__name:"address_edit",setup(a){const t=l({id:0,name:"",mobile:"",province_id:0,city_id:0,district_id:0,address:"",full_address:"",is_default:0,area:"",type:"address"}),r=l(),i=l(null),s=l(""),v=l(""),y=l(!1);j((e=>{e.id&&V(e.id).then((({data:e})=>{e&&Object.assign(t.value,e)})).catch(),s.value=e.type||"",v.value=e.source||""}));const _=P((()=>({name:{type:"string",required:!0,message:q("namePlaceholder"),trigger:["blur","change"]},mobile:[{type:"string",required:!0,message:q("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error(q("mobileError")))}}],area:{validator:()=>!uni.$u.test.isEmpty(t.value.area),message:q("selectAreaPlaceholder")},address:{type:"string",required:!0,message:q("addressPlaceholder"),trigger:["blur","change"]}}))),b=()=>{r.value.open()},h=e=>{t.value.province_id=e.province.id||0,t.value.city_id=e.city.id||0,t.value.district_id=e.district.id||0,t.value.area=`${e.province.name||""}${e.city.name||""}${e.district.name||""}`},x=l(!1),g=()=>{const e=t.value.id?$:E;i.value.validate().then((()=>{x.value||(x.value=!0,y.value=!0,t.value.full_address=t.value.area+t.value.address,e(t.value).then((e=>{x.value=!1,setTimeout((()=>{y.value=!1,U({url:"/app/pages/member/address",mode:"redirectTo",param:{type:s.value,source:v.value}})}),1e3)})).catch((()=>{x.value=!1,y.value=!1})))}))};return(a,l)=>{const s=d(o("u-input"),e),v=d(o("u-form-item"),I),C=k,j=d(o("u-switch"),M),V=d(o("u-button"),O),P=d(o("u-form"),T),$=d(o("area-select"),z);return c(),u(C,{class:"px-[30rpx]",style:A(a.themeColor())},{default:n((()=>[p(P,{labelPosition:"left",model:t.value,labelWidth:"200rpx",errorType:"toast",rules:w(_),ref_key:"formRef",ref:i},{default:n((()=>[p(C,{class:"mt-[10rpx]"},{default:n((()=>[p(v,{label:w(q)("name"),prop:"name","border-bottom":!0},{default:n((()=>[p(s,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.name=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"25",placeholder:w(q)("namePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),p(C,{class:"mt-[10rpx]"},{default:n((()=>[p(v,{label:w(q)("mobile"),prop:"mobile","border-bottom":!0},{default:n((()=>[p(s,{modelValue:t.value.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value.mobile=e),border:"none",clearable:"",placeholder:w(q)("mobilePlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),p(C,{class:"mt-[10rpx]"},{default:n((()=>[p(v,{label:w(q)("selectArea"),prop:"area","border-bottom":!0,onClick:b},{default:n((()=>[t.value.area?(c(),u(C,{key:1,class:"text-[30rpx]"},{default:n((()=>[m(f(t.value.area),1)])),_:1})):(c(),u(C,{key:0,class:"text-gray-placeholder text-[30rpx]"},{default:n((()=>[m(f(w(q)("selectAreaPlaceholder")),1)])),_:1}))])),_:1},8,["label"])])),_:1}),p(C,{class:"mt-[10rpx]"},{default:n((()=>[p(v,{label:w(q)("address"),prop:"address","border-bottom":!0},{default:n((()=>[p(s,{modelValue:t.value.address,"onUpdate:modelValue":l[2]||(l[2]=e=>t.value.address=e),modelModifiers:{trim:!0},border:"none",clearable:"",maxlength:"120",placeholder:w(q)("addressPlaceholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),p(C,{class:"mt-[10rpx]"},{default:n((()=>[p(v,{label:w(q)("defaultAddress"),prop:"name","border-bottom":!0},{default:n((()=>[p(j,{modelValue:t.value.is_default,"onUpdate:modelValue":l[3]||(l[3]=e=>t.value.is_default=e),size:"20",activeValue:1,inactiveValue:0,activeColor:"var(--primary-color)"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),p(C,{class:"mt-[40rpx]"},{default:n((()=>[p(V,{type:"primary",shape:"circle",text:w(q)("save"),onClick:g,disabled:y.value,loading:x.value},null,8,["text","disabled","loading"])])),_:1})])),_:1},8,["model","rules"]),p($,{ref_key:"areaRef",ref:r,onComplete:h,"area-id":t.value.district_id},null,8,["area-id"])])),_:1},8,["style"])}}});export{D as default};

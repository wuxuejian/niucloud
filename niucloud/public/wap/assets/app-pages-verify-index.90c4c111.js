import{d as a,r as e,af as s,a2 as t,S as l,a3 as o,o as n,c,w as i,u as r,b as u,D as f,e as p,v as d,aG as _,f as x,n as m,aC as g,bO as v,a as y,F as h,i as b,a9 as C,ah as w,g as j,h as V}from"./index-000ef0fb.js";import{_ as k}from"./u-loading-page.41f97929.js";import{g as I,a as S}from"./verify.06868c24.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.d02ed416.js";import"./u-transition.3ad24640.js";const D=z(a({__name:"index",setup(a){let z=e("manualInput");z.value="manualInput";let D=e(!1),F=e(""),G=e(!0);s((()=>{t()&&H()}));const H=()=>{I().then((a=>{a.data?G.value=!1:(l({title:"非核销员无此权限",icon:"none"}),setTimeout((()=>{o()}),1e3))}))},O=()=>{g()&&(v.init(),v.scanQRCode((a=>{if(a.resultStr){let e=a.resultStr;y({url:"/app/pages/verify/verify",param:{code:e}})}})))};let Q=!1;const R=()=>{if(Q)return!1;Q=!0;if(!/[\S]+/.test(F.value))return l({title:"请输入核销码",icon:"none"}),!1;S(F.value).then((a=>{Q=!1,y({url:"/app/pages/verify/verify",param:{code:F.value}})})).catch((()=>{Q=!1}))},T=()=>{D.value=!D.value},U=a=>{"sweepCode"!=a||g()?z.value=a:l({title:"H5端不支持扫码核销",icon:"none"})};return(a,e)=>{const s=h,t=b,l=C,o=w,g=j(V("u-loading-page"),k);return n(),c(t,{style:m(a.themeColor())},{default:i((()=>[r(G)?x("v-if",!0):(n(),c(t,{key:0,class:"container"},{default:i((()=>[u(t,{class:"action-wrap"},{default:i((()=>[u(t,{class:"record-wrap text-[var(--primary-color)]",onClick:e[0]||(e[0]=a=>r(y)({url:"/app/pages/verify/record"}))},{default:i((()=>[u(s,{class:"iconfont iconjilu color-base-text"}),u(s,{class:"text-[28rpx]"},{default:i((()=>[f("核销记录")])),_:1})])),_:1}),p(u(t,{class:"sweep-code flex items-center justify-center ns-gradient-otherpages-member-balance-balance-rechange",onClick:O},{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx text-[130rpx] text-[#fff]"})])),_:1},512),[[d,"sweepCode"==r(z)]]),p(u(t,{class:"manual-input"},{default:i((()=>[u(t,{class:"process-wrap"},{default:i((()=>[u(t,{class:"wrap"},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconVector-77 color-base-text"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("输入核销码")])),_:1})])),_:1}),u(t,null,{default:i((()=>[u(t,null,{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-changjiantouV6xx color-tip"})])),_:1})])),_:1}),u(t,{class:"wrap"},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconhexiao color-base-text"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("核销")])),_:1})])),_:1})])),_:1}),u(l,{type:"text",placeholder:"请输入核销码",class:"_input","placeholder-class":"_placeholder",modelValue:r(F),"onUpdate:modelValue":e[1]||(e[1]=a=>_(F)?F.value=a:F=a),focus:r(D),ref:"input"},null,8,["modelValue","focus"]),u(t,{class:"_btn",onClick:R},{default:i((()=>[u(o,{class:"h-[80rpx] flex items-center justify-center !text-[28rpx]",type:"primary"},{default:i((()=>[f("确认")])),_:1})])),_:1})])),_:1},512),[[d,"manualInput"==r(z)]])])),_:1}),u(t,{class:"arc-edge"}),u(t,{class:"action-type-wrap"},{default:i((()=>[u(t,{class:"action",onClick:e[2]||(e[2]=a=>U("sweepCode"))},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"nc-iconfont nc-icon-saoyisaoV6xx"})])),_:1}),u(t,{class:"_text"},{default:i((()=>[f("扫码核销")])),_:1})])),_:1}),u(t,{class:"nc-iconfont nc-icon-saotiaoxingmaV6xx ns-gradient-otherpages-member-balance-balance-rechange"}),u(t,{class:"action",onClick:e[3]||(e[3]=a=>U("manualInput"))},{default:i((()=>[u(t,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconVector-77"})])),_:1}),u(t,{class:"_text",onClick:T},{default:i((()=>[f("手动输入")])),_:1})])),_:1})])),_:1})])),_:1})),u(g,{loading:r(G),"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-fb8aefc2"]]);export{D as default};

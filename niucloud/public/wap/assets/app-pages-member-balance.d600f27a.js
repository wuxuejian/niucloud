import{B as e,C as a,D as t,q as r,t as o,i as l,j as s,w as i,k as n,p as d,m as u,G as p,_ as c,x as m,d as y,a8 as g,r as h,ai as f,e as _,F as v,H as b,I as x,n as w,L as k,ab as S,Q as C,S as E,R as $,y as I,T as L,ag as j,K as U,aj as B,a as T,b as F,aa as R,l as H,v as z,ah as O,J as M}from"./index-6f7dfcc0.js";import{_ as N}from"./u-loading-page.007a6425.js";import{_ as P}from"./u-button.2c6f4da9.js";import{_ as A}from"./u-icon.4a3c5455.js";import{_ as q}from"./u-transition.77d401ec.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as G}from"./u-popup.1c7e0660.js";import{p as J,g as K}from"./pay.a7760228.js";import{w as Q}from"./wechat.ec95f9a4.js";import"./u-loading-icon.8bd45fe0.js";import"./u-safe-bottom.fa559bf3.js";const W=D({name:"u-image",mixins:[a,t,{props:{src:{type:String,default:e.image.src},mode:{type:String,default:e.image.mode},width:{type:[String,Number],default:e.image.width},height:{type:[String,Number],default:e.image.height},shape:{type:String,default:e.image.shape},radius:{type:[String,Number],default:e.image.radius},lazyLoad:{type:Boolean,default:e.image.lazyLoad},showMenuByLongpress:{type:Boolean,default:e.image.showMenuByLongpress},loadingIcon:{type:String,default:e.image.loadingIcon},errorIcon:{type:String,default:e.image.errorIcon},showLoading:{type:Boolean,default:e.image.showLoading},showError:{type:Boolean,default:e.image.showError},fade:{type:Boolean,default:e.image.fade},webp:{type:Boolean,default:e.image.webp},duration:{type:[String,Number],default:e.image.duration},bgColor:{type:String,default:e.image.bgColor}}}],data(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{},show:!1}},watch:{src:{immediate:!0,handler(e){e?(this.isError=!1,this.loading=!0):this.isError=!0}}},computed:{wrapStyle(){let e={};return e.width=this.$u.addUnit(this.width),e.height=this.$u.addUnit(this.height),e.borderRadius="circle"==this.shape?"10000px":uni.$u.addUnit(this.radius),e.overflow=this.radius>0?"hidden":"visible",uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},mounted(){this.show=!0},emits:["click","error","load"],methods:{onClick(){this.$emit("click")},onErrorHandler(e){this.loading=!1,this.isError=!0,this.$emit("error",e)},onLoadHandler(e){this.loading=!1,this.isError=!1,this.$emit("load",e),this.removeBgColor()},removeBgColor(){this.backgroundStyle={backgroundColor:"transparent"}}}},[["render",function(e,a,t,y,g,h){const f=c,_=r(o("u-icon"),A),v=m,b=r(o("u-transition"),q);return l(),s(b,{mode:"fade",show:g.show,duration:e.fade?1e3:0},{default:i((()=>[n(v,{class:"u-image",onClick:h.onClick,style:d([h.wrapStyle,g.backgroundStyle])},{default:i((()=>[g.isError?u("v-if",!0):(l(),s(f,{key:0,src:e.src,mode:e.mode,onError:h.onErrorHandler,onLoad:h.onLoadHandler,"show-menu-by-longpress":e.showMenuByLongpress,"lazy-load":e.lazyLoad,class:"u-image__image",style:d({borderRadius:"circle"==e.shape?"10000px":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},null,8,["src","mode","onError","onLoad","show-menu-by-longpress","lazy-load","style"])),e.showLoading&&g.loading?(l(),s(v,{key:1,class:"u-image__loading",style:d({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),backgroundColor:this.bgColor,width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:i((()=>[p(e.$slots,"loading",{},(()=>[n(_,{name:e.loadingIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):u("v-if",!0),e.showError&&g.isError&&!g.loading?(l(),s(v,{key:2,class:"u-image__error",style:d({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:i((()=>[p(e.$slots,"error",{},(()=>[n(_,{name:e.errorIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):u("v-if",!0)])),_:3},8,["onClick","style"])])),_:3},8,["show","duration"])}],["__scopeId","data-v-466b6710"]]),X=D(y({__name:"pay",emits:["close"],setup(e,{expose:a,emit:t}){g()&&Q.init();const d=h(!1),p=h(!1),c=h(null),y=h(""),U=()=>{var e,a;uni.$u.test.isEmpty(y.value)?L({title:k("pay.notHavePayType"),icon:"none"}):p.value||(p.value=!0,J({trade_type:null==(e=c.value)?void 0:e.trade_type,trade_id:null==(a=c.value)?void 0:a.trade_id,type:y.value}).then((e=>{var a,t,r,o,l,s;switch(y.value){case"wechatpay":g()?(e.data.timestamp=e.data.timeStamp,delete e.data.timeStamp,Q.pay({...e.data,success:()=>{B()},cancel:()=>{p.value=!1}})):(uni.setStorageSync("paymenting",{trade_type:null==(a=c.value)?void 0:a.trade_type,trade_id:null==(t=c.value)?void 0:t.trade_id}),location.href=e.data.h5_url);break;case"alipay":g()?_({url:"/app/pages/pay/browser",param:{trade_type:null==(r=c.value)?void 0:r.trade_type,trade_id:null==(o=c.value)?void 0:o.trade_id,alipay:encodeURIComponent(e.data.url)},mode:"redirectTo"}):(uni.setStorageSync("paymenting",{trade_type:null==(l=c.value)?void 0:l.trade_type,trade_id:null==(s=c.value)?void 0:s.trade_id}),location.href=e.data.url);break;default:B()}})).catch((()=>{p.value=!1})))};f("checkIsReturnAfterPayment",(()=>{const e=uni.getStorageSync("paymenting");uni.getStorageSync("paymenting")&&_({url:"/app/pages/pay/result",param:{trade_type:e.trade_type,trade_id:e.trade_id},mode:"redirectTo",success(){uni.removeStorageSync("paymenting")}})}));const B=()=>{var e,a;_({url:"/app/pages/pay/result",param:{trade_type:null==(e=c.value)?void 0:e.trade_type,trade_id:null==(a=c.value)?void 0:a.trade_id},mode:"redirectTo"})},T=()=>{uni.removeStorageSync("paymenting"),d.value=!1,t("close")};return a({open:(e,a,t="")=>{uni.setStorageSync("payReturn",encodeURIComponent(t)),K(e,a).then((e=>{let{data:a}=e;c.value=a,uni.$u.test.isEmpty(a)?L({title:k("pay.notObtainedInfo"),icon:"none"}):0!=a.money?(y.value=a.pay_type_list[0]?a.pay_type_list[0].key:"",d.value=!0):B()})).catch((()=>{}))}}),(e,a)=>{const t=m,g=r(o("u-image"),W),h=r(o("u-icon"),A),f=j,_=r(o("u-button"),P),L=r(o("u-popup"),G);return l(),s(L,{show:d.value,round:10,onClose:T,closeable:!0,bgColor:"#fff",zIndex:"10081",closeOnClickOverlay:!1},{default:i((()=>[c.value?(l(),s(t,{key:0,class:"flex flex-col h-[75vh]",onTouchmove:a[0]||(a[0]=v((()=>{}),["prevent","stop"]))},{default:i((()=>[n(t,{class:"head"},{default:i((()=>[n(t,{class:"text-center py-[26rpx]"},{default:i((()=>[b(x(w(k)("pay.payTitle")),1)])),_:1}),n(t,{class:"flex items-end justify-center w-full text-xl font-bold py-[20rpx]"},{default:i((()=>[n(t,{class:"text-base mr-[4rpx]"},{default:i((()=>[b(x(w(k)("currency")),1)])),_:1}),b(" "+x(w(S)(c.value.money)),1)])),_:1})])),_:1}),n(f,{"scroll-y":"true",class:"flex-1 pt-[20rpx]"},{default:i((()=>[n(t,{class:"flex text-sm px-[30rpx] py-[20rpx]"},{default:i((()=>[n(t,{class:"text-gray-500"},{default:i((()=>[b(x(w(k)("pay.orderInfo")),1)])),_:1}),n(t,{class:"text-right flex-1 pl-[30rpx] truncate"},{default:i((()=>[b(x(c.value.body),1)])),_:1})])),_:1}),n(t,{class:"mx-[30rpx] py-[10rpx] px-[30rpx] bg-white rounded-md bg-page"},{default:i((()=>[c.value.pay_type_list.length?(l(!0),C(E,{key:0},$(c.value.pay_type_list,((e,a)=>(l(),s(t,{class:"pay-item py-[18rpx] flex items-center border-0 border-b border-solid border-[#eee]",key:a,onClick:a=>y.value=e.key},{default:i((()=>[n(g,{src:w(I)(e.icon),width:"50rpx",height:"50rpx"},null,8,["src"]),n(t,{class:"flex-1 px-[20rpx] text-sm font-bold"},{default:i((()=>[b(x(e.name),1)])),_:2},1024),e.key==y.value?(l(),s(h,{key:0,name:"checkbox-mark",color:"var(--primary-color)"})):u("v-if",!0)])),_:2},1032,["onClick"])))),128)):(l(),s(t,{key:1,class:"py-[20rpx] text-center text-sm text-gray-subtitle"},{default:i((()=>[b(x(w(k)("pay.notHavePayType")),1)])),_:1}))])),_:1})])),_:1}),n(t,{class:"p-[30rpx]"},{default:i((()=>[n(_,{type:"primary",loading:p.value,text:w(k)("pay.confirmPay"),shape:"circle",onClick:U},null,8,["loading","text"])])),_:1})])),_:1})):u("v-if",!0)])),_:1},8,["show"])}}}),[["__scopeId","data-v-f08c60b8"]]),Y=D(y({__name:"balance",setup(e){const a=U(),t=B(),p=T({is_auto_transfer:0,is_auto_verify:0,is_open:0,min:0,rate:0,transfer_type:[]}),y=h(!0);F((()=>{R().then((e=>{for(let a in e.data)p[a]=e.data[a];y.value=!1}))}));const g=()=>{O("cashOutAccountType","money"),_({url:"/app/pages/member/apply_cash_out"})};return(e,h)=>{const f=r(o("u-loading-page"),N),v=m,C=c,E=M,$=r(o("u-button"),P),L=r(o("pay"),X);return l(),s(v,{style:d(e.themeColor())},{default:i((()=>[n(f,{loading:y.value,loadingText:""},null,8,["loading"]),H(n(v,{class:"account-info-wrap"},{default:i((()=>[n(v,{class:"account-info-head",style:d({background:"url("+w(I)("static/resource/images/member/balance_bg.png")+") no-repeat 95% 30% / auto 250rpx, linear-gradient(314deg, #FE7849 0%, #FF1959 100%)"})},{default:i((()=>[n(v,{class:"name"},{default:i((()=>[b(x(w(k)("balanceInfo")),1)])),_:1}),n(v,{class:"content"},{default:i((()=>[n(v,{class:"money"},{default:i((()=>[b(x(w(a).info?w(S)((parseFloat(w(a).info.balance)+parseFloat(w(a).info.money)).toString()):"0.00"),1)])),_:1}),n(v,{class:"text"},{default:i((()=>[b(x(w(k)("accountBalance")),1)])),_:1}),n(v,{class:"money-wrap"},{default:i((()=>[n(v,{class:"money-item",onClick:h[0]||(h[0]=e=>w(_)({url:"/app/pages/member/detailed_account",param:{type:"balance"}}))},{default:i((()=>[n(v,{class:"money"},{default:i((()=>{var e;return[b(x(w(S)(null==(e=w(a).info)?void 0:e.balance)||"0.00"),1)]})),_:1}),n(v,{class:"text leading-none"},{default:i((()=>[b(x(w(k)("balance")),1)])),_:1})])),_:1}),n(v,{class:"money-item",onClick:h[1]||(h[1]=e=>w(_)({url:"/app/pages/member/detailed_account",param:{type:"money"}}))},{default:i((()=>[n(v,{class:"money"},{default:i((()=>{var e;return[b(x(w(S)(null==(e=w(a).info)?void 0:e.money)||"0.00"),1)]})),_:1}),n(v,{class:"text leading-none"},{default:i((()=>[b(x(w(k)("money")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),n(v,{class:"account-info-btn"},{default:i((()=>[w(t).siteAddons.includes("recharge")?(l(),s($,{key:0,type:"primary",shape:"circle",class:"btn",customStyle:{backgroundColor:"#FE4E50",color:"#fff",borderColor:"#FE4E50",width:"calc(100vw - 64rpx)"},onClick:h[2]||(h[2]=e=>w(_)({url:"/addon/recharge/pages/recharge"}))},{default:i((()=>[n(C,{class:"max-w-[36rpx] max-h-[36rpx] mr-1",src:w(I)("static/resource/images/member/reset.png")},null,8,["src"]),n(E,null,{default:i((()=>[b(x(w(k)("recharge")),1)])),_:1})])),_:1},8,["customStyle"])):u("v-if",!0),1==p.is_open?(l(),s($,{key:1,type:"primary",plain:!0,shape:"circle",class:"btn",customStyle:{backgroundColor:"#fff",color:"#FE4E50",borderColor:"#FE4E50",width:"calc(100vw - 64rpx)"},onClick:g},{default:i((()=>[n(C,{class:"max-w-[36rpx] max-h-[36rpx] mr-1",src:w(I)("static/resource/images/member/withdraw_deposit.png")},null,8,["src"]),n(E,null,{default:i((()=>[b(x(w(k)("cashOut")),1)])),_:1})])),_:1},8,["customStyle"])):u("v-if",!0)])),_:1}),n(L,{ref:"payRef",onClose:h[3]||(h[3]=a=>e.rechargeLoading=!1)},null,512)])),_:1},512),[[z,!y.value]])])),_:1},8,["style"])}}}),[["__scopeId","data-v-8083664e"]]);export{Y as default};

import{d as a,r as e,ah as s,a6 as l,R as t,a7 as o,o as n,c,w as i,u as r,b as u,D as p,e as d,v as f,aJ as _,f as m,n as g,a5 as x,a as v,F as h,i as y,ad as b,aG as w,g as C,h as j}from"./index-f0b22e55.js";import{_ as k}from"./u-loading-page.c4f05309.js";import{g as I,a as S}from"./verify.d2ea4b6d.js";import{w as V}from"./wechat.48f9853d.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-loading-icon.c77adce6.js";import"./u-transition.95f24654.js";const q=R(a({__name:"index",setup(a){let R=e("manualInput");R.value="manualInput";let q=e(!1),z=e(""),D=e(!0);s((()=>{l()&&F()}));const F=()=>{I().then((a=>{a.data?D.value=!1:(t({title:"非核销员无此权限",icon:"none"}),setTimeout((()=>{o()}),1e3))}))},G=()=>{x()&&(V.init(),V.scanQRCode((a=>{if(a.resultStr){let e=a.resultStr;v({url:"/app/pages/verify/verify",param:{code:e}})}})))};let H=!1;const J=()=>{if(H)return!1;H=!0;if(!/[\S]+/.test(z.value))return t({title:"请输入核销码",icon:"none"}),!1;S(z.value).then((a=>{H=!1,v({url:"/app/pages/verify/verify",param:{code:z.value}})}))},Q=()=>{q.value=!q.value},T=a=>{"sweepCode"!=a||x()?R.value=a:t({title:"H5端不支持扫码核销",icon:"none"})};return(a,e)=>{const s=h,l=y,t=b,o=w,x=C(j("u-loading-page"),k);return n(),c(l,{style:g(a.themeColor())},{default:i((()=>[r(D)?m("v-if",!0):(n(),c(l,{key:0,class:"container"},{default:i((()=>[u(l,{class:"action-wrap"},{default:i((()=>[u(l,{class:"record-wrap text-[var(--primary-color)]",onClick:e[0]||(e[0]=a=>r(v)({url:"/app/pages/verify/record"}))},{default:i((()=>[u(s,{class:"iconfont iconjilu color-base-text"}),u(s,{class:"text-[28rpx]"},{default:i((()=>[p("核销记录")])),_:1})])),_:1}),d(u(l,{class:"sweep-code ns-gradient-otherpages-member-balance-balance-rechange",onClick:G},{default:i((()=>[u(s,{class:"iconfont iconsaoma"})])),_:1},512),[[f,"sweepCode"==r(R)]]),d(u(l,{class:"manual-input"},{default:i((()=>[u(l,{class:"process-wrap"},{default:i((()=>[u(l,{class:"wrap"},{default:i((()=>[u(l,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconshurutianxiebi color-base-text"})])),_:1}),u(l,{class:"_text"},{default:i((()=>[p("输入核销码")])),_:1})])),_:1}),u(l,null,{default:i((()=>[u(l,null,{default:i((()=>[u(s,{class:"iconfont iconjiang-copy color-tip"})])),_:1})])),_:1}),u(l,{class:"wrap"},{default:i((()=>[u(l,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconhexiao color-base-text"})])),_:1}),u(l,{class:"_text"},{default:i((()=>[p("核销")])),_:1})])),_:1})])),_:1}),u(t,{type:"text",placeholder:"请输入核销码",class:"_input","placeholder-class":"_placeholder",modelValue:r(z),"onUpdate:modelValue":e[1]||(e[1]=a=>_(z)?z.value=a:z=a),focus:r(q),ref:"input"},null,8,["modelValue","focus"]),u(l,{class:"_btn",onClick:J},{default:i((()=>[u(o,{class:"h-[80rpx] flex items-center justify-center !text-[28rpx]",type:"primary"},{default:i((()=>[p("确认")])),_:1})])),_:1})])),_:1},512),[[f,"manualInput"==r(R)]])])),_:1}),u(l,{class:"arc-edge"}),u(l,{class:"action-type-wrap"},{default:i((()=>[u(l,{class:"action",onClick:e[2]||(e[2]=a=>T("sweepCode"))},{default:i((()=>[u(l,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconsaoma"})])),_:1}),u(l,{class:"_text"},{default:i((()=>[p("扫码核销")])),_:1})])),_:1}),u(l,{class:"iconfont icontiaoxingmasaomiao ns-gradient-otherpages-member-balance-balance-rechange"}),u(l,{class:"action",onClick:e[3]||(e[3]=a=>T("manualInput"))},{default:i((()=>[u(l,{class:"_icon"},{default:i((()=>[u(s,{class:"iconfont iconshuru"})])),_:1}),u(l,{class:"_text",onClick:Q},{default:i((()=>[p("手动输入")])),_:1})])),_:1})])),_:1})])),_:1})),u(x,{loading:r(D),"loading-text":"",loadingColor:"var(--primary-color)",iconSize:"35"},null,8,["loading"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-b2eca763"]]);export{q as default};

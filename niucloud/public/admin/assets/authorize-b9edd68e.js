import{d as Z,r as l,l as ee,n as H,q as n,a2 as P,h as r,c as C,s as x,w as a,a as e,u as i,i as p,e as s,t as m,B as E,F as te,T as ae,U as se,a3 as oe,a4 as le,E as ne,a1 as re,a5 as ie,K as ce,L as de,a6 as ue,M as pe,X as _e,a7 as me,a8 as fe}from"./index-39857e33.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                  *//* empty css                   *//* empty css                  */import{g as xe,a as he,s as ve}from"./module-48d8d822.js";import ge from"./index-3142e593.js";import{C as ye}from"./index-b7557d6d.js";/* empty css               *//* empty css                     *//* empty css                 */import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                   */const we={class:"main-container"},ke={class:"flex"},Ce={class:"w-[450px] mr-[20px] p-[50px] bg-[var(--el-color-info-light-9)]"},Ve={class:"flex items-center justify-between"},be=e("span",{class:"text-page-title"},"版本信息",-1),Be={class:"flex-1 w-0 flex justify-end"},Te={class:"mt-[30px] flex items-center text-[14px] text-[#797979]"},Ee=e("span",null,"当前版本",-1),Ie={class:"text-[26px] ml-[15px] mr-[10px] text-[#656668]"},Ae={key:0,class:"text-[12px]"},Fe={key:1,class:"text-[12px] text-[red]"},Le={class:"flex flex-1 justify-between items-center p-[50px] bg-[var(--el-color-info-light-9)]"},Me={class:"flex flex-col"},Re={class:"flex flex-wrap items-center"},De=e("p",{class:"text-page-title mr-[20px]"},"授权信息",-1),Ne={class:"text-[14px] text-[#666]"},Ue={class:"mt-[46px] ml-[40px] flex flex-wrap"},je={class:"text-[14px] mr-[84px]"},He={class:"ml-[12px] text-[12px]"},Pe={class:"text-[14px] flex items-center"},Se=e("span",null,"授权码",-1),ze={class:"ml-[12px] mr-[10px] text-[12px]"},$e={class:"flex flex-1 flex-wrap justify-end relative"},qe={class:"px-[18px] py-[8px]"},Je=e("p",{class:"leading-[32px] text-[14px]"},"您在官方应用市场购买任意一款应用，即可获得授权码。输入正确授权码认证通过后，即可支持在线升级和其它相关服务 ",-1),Oe={class:"flex justify-end mt-[36px]"},Ke={class:"mt-[20px]"},Xe={class:"text-sm mt-[10px] text-info"},Ge={class:"mt-[20px]"},Qe={class:"mt-[10px] text-right"},We=e("div",{class:"text-page-title mb-[20px]"},"历史版本",-1),Ye={key:0,class:"mt-[10px] p-[20px] bg-overlay rounded-md timeline-log-wrap whitespace-pre"},Ze=["innerHTML"],gt=Z({__name:"authorize",setup(et){const I=l(null),y=l(null),A=l(null),h=l(!1),v=l(!1),V=l([]),F=l(!1),L=()=>{xe().then(({data:o})=>{V.value=o,F.value?(!d.value||d.value&&d.value.version_no==k.value)&&se({message:n("versionTips"),type:"success"}):F.value=!0})};L();const d=ee(()=>V.value.length?V.value[0]:null),S=o=>{const t=JSON.parse(JSON.stringify(o));return t.slice(0,t.length/2)+t.slice(t.length/2,t.length-1).replace(/./g,"*")},B=()=>{h.value=!0},_=l({company_name:"",site_address:"",auth_code:""}),b=l(!0),w=l(!1),M=()=>{he().then(o=>{b.value=!1,o.data.data&&o.data.data.length!=0&&(_.value=o.data.data,h.value=!1)}).catch(()=>{b.value=!1,h.value=!1})};M();const g=H({auth_code:"",auth_secret:""}),R=l(),z=H({auth_code:[{required:!0,message:n("authCodePlaceholder"),trigger:"blur"}],auth_secret:[{required:!0,message:n("authSecretPlaceholder"),trigger:"blur"}]}),$=async o=>{w.value||!o||await o.validate(async t=>{t&&(w.value=!0,ve(g).then(()=>{w.value=!1,M()}).catch(()=>{w.value=!1,h.value=!1}))})},D=()=>{window.open("https://www.niucloud.com/app")},k=l("");(()=>{oe().then(o=>{k.value=o.data.version.version})})();const q=()=>{var o;if(!_.value.auth_code){B();return}(o=I.value)==null||o.open()},J=()=>{var o;if(!_.value.auth_code){B();return}if(y.value.cloudBuildTask){(o=y.value)==null||o.open();return}le.confirm(n("cloudBuildTips"),n("warning"),{confirmButtonText:n("confirm"),cancelButtonText:n("cancel"),type:"warning"}).then(()=>{var t;(t=y.value)==null||t.open()})};return(o,t)=>{const u=ne,O=P("View"),N=re,K=P("Hide"),X=ie,U=ce,j=de,T=ue,G=pe,Q=_e,W=me,Y=fe;return r(),C("div",we,[b.value?E("",!0):(r(),x(T,{key:0,class:"box-card !border-none",shadow:"never"},{default:a(()=>{var f;return[e("div",ke,[e("div",Ce,[e("div",Ve,[be,e("div",Be,[!i(d)||i(d)&&i(d).version_no==k.value?(r(),x(u,{key:0,class:"text-[#4C4C4C] w-[78px] h-[32px] !bg-transparent",onClick:L},{default:a(()=>[p("检测更新")]),_:1})):(r(),x(u,{key:1,class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:q},{default:a(()=>[p("一键升级")]),_:1})),s(u,{class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:J,loading:(f=y.value)==null?void 0:f.loading},{default:a(()=>[p("云编译")]),_:1},8,["loading"])])]),e("div",Te,[Ee,e("span",Ie,m(k.value),1),!i(d)||i(d)&&i(d).version_no==k.value?(r(),C("em",Ae,"(当前已是最新版本)")):(r(),C("em",Fe,"(最新版本"+m(i(d).version_no)+")",1))])]),e("div",Le,[e("div",Me,[e("div",Re,[De,e("span",Ne,m(_.value.company_name||"--"),1)]),e("div",Ue,[e("span",je,[p("授权域名"),e("em",He,m(_.value.site_address||"--"),1)]),e("span",Pe,[Se,e("em",ze,m(_.value.auth_code?v.value?_.value.auth_code:S(_.value.auth_code):"--"),1),v.value?(r(),x(N,{key:1,onClick:t[1]||(t[1]=c=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:a(()=>[s(K)]),_:1})):(r(),x(N,{key:0,onClick:t[0]||(t[0]=c=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:a(()=>[s(O)]),_:1}))])])]),e("div",$e,[s(u,{class:"w-[154px] !h-[48px] mt-[8px]",type:"primary",onClick:B},{default:a(()=>[p("授权码认证")]),_:1}),s(X,{ref_key:"getAuthCodeDialog",ref:A,placement:"bottom-start",width:478,trigger:"click",class:"mt-[8px]"},{reference:a(()=>[s(u,{class:"w-[154px] !h-[48px] mt-[8px] !text-[var(--el-color-primary)] hover:!text-[var(--el-color-primary)] !bg-transparent",plain:"",type:"primary"},{default:a(()=>[p("如何获取授权码?")]),_:1})]),default:a(()=>[e("div",qe,[Je,e("div",Oe,[s(u,{class:"w-[182px] !h-[48px]",plain:"",onClick:D},{default:a(()=>[p("去应用市场逛逛")]),_:1}),s(u,{class:"w-[100px] !h-[48px]",plain:"",onClick:t[2]||(t[2]=c=>A.value.hide())},{default:a(()=>[p("关闭")]),_:1})])])]),_:1},512)]),s(Q,{modelValue:h.value,"onUpdate:modelValue":t[6]||(t[6]=c=>h.value=c),title:"授权码认证",width:"400px"},{default:a(()=>[s(G,{model:g,"label-width":"0",ref_key:"formRef",ref:R,rules:z,class:"page-form"},{default:a(()=>[s(T,{class:"box-card !border-none",shadow:"never"},{default:a(()=>[s(j,{prop:"auth_code"},{default:a(()=>[s(U,{modelValue:g.auth_code,"onUpdate:modelValue":t[3]||(t[3]=c=>g.auth_code=c),modelModifiers:{trim:!0},placeholder:i(n)("authCodePlaceholder"),class:"input-width",clearable:"",size:"large"},null,8,["modelValue","placeholder"])]),_:1}),e("div",Ke,[s(j,{prop:"auth_secret"},{default:a(()=>[s(U,{modelValue:g.auth_secret,"onUpdate:modelValue":t[4]||(t[4]=c=>g.auth_secret=c),modelModifiers:{trim:!0},clearable:"",placeholder:i(n)("authSecretPlaceholder"),class:"input-width",size:"large"},null,8,["modelValue","placeholder"])]),_:1})]),e("div",Xe,m(i(n)("authInfoTips")),1),e("div",Ge,[s(u,{type:"primary",class:"w-full",size:"large",loading:w.value,onClick:t[5]||(t[5]=c=>$(R.value))},{default:a(()=>[p(m(i(n)("confirm")),1)]),_:1},8,["loading"])]),e("div",Qe,[s(u,{type:"primary",link:"",onClick:D},{default:a(()=>[p(m(i(n)("notHaveAuth")),1)]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])])]}),_:1})),b.value?E("",!0):(r(),x(T,{key:1,class:"box-card !border-none",shadow:"never"},{default:a(()=>[We,s(Y,null,{default:a(()=>[(r(!0),C(te,null,ae(V.value,(f,c)=>(r(),x(W,{timestamp:f.release_time+" 版本："+f.version_no,type:"primary",hollow:!0,placement:"top",key:c},{default:a(()=>[f.upgrade_log?(r(),C("div",Ye,[e("div",{innerHTML:f.upgrade_log},null,8,Ze)])):E("",!0)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})),s(ge,{ref_key:"upgradeRef",ref:I},null,512),s(ye,{ref_key:"cloudBuildRef",ref:y},null,512)])}}});export{gt as default};

import{d as Y,r as i,l as Z,n as H,q as c,a2 as P,h as l,c as k,s as f,w as a,a as e,u as n,i as p,e as o,t as _,B as E,F as ee,T as te,a3 as ae,a4 as oe,E as se,a1 as le,a5 as ne,K as re,L as ie,a6 as ce,M as de,X as pe,a7 as ue,a8 as _e}from"./index-34979a7f.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                  *//* empty css                   *//* empty css                  */import{g as me,a as xe,s as fe}from"./module-610833c0.js";import he from"./index-2376a724.js";import{C as ve}from"./index-06c15095.js";/* empty css               *//* empty css                     *//* empty css                 */import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                   */const ge={class:"main-container"},ye={class:"flex"},we={class:"w-[450px] mr-[20px] p-[50px] bg-[var(--el-color-info-light-9)]"},ke={class:"flex items-center justify-between"},Ce=e("span",{class:"text-page-title"},"版本信息",-1),Ve={class:"flex-1 w-0 flex justify-end"},be={class:"mt-[30px] flex items-center text-[14px] text-[#797979]"},Be=e("span",null,"当前版本",-1),Te={class:"text-[26px] ml-[15px] mr-[10px] text-[#656668]"},Ee={key:0,class:"text-[12px]"},Ae={key:1,class:"text-[12px] text-[red]"},Fe={class:"flex flex-1 justify-between items-center p-[50px] bg-[var(--el-color-info-light-9)]"},Ie={class:"flex flex-col"},Le={class:"flex flex-wrap items-center"},Me=e("p",{class:"text-page-title mr-[20px]"},"授权信息",-1),Re={class:"text-[14px] text-[#666]"},De={class:"mt-[46px] ml-[40px] flex flex-wrap"},Ne={class:"text-[14px] mr-[84px]"},je={class:"ml-[12px] text-[12px]"},He={class:"text-[14px] flex items-center"},Pe=e("span",null,"授权码",-1),Se={class:"ml-[12px] mr-[10px] text-[12px]"},Ue={class:"flex flex-1 flex-wrap justify-end relative"},ze={class:"px-[18px] py-[8px]"},$e=e("p",{class:"leading-[32px] text-[14px]"},"您在官方应用市场购买任意一款应用，即可获得授权码。输入正确授权码认证通过后，即可支持在线升级和其它相关服务 ",-1),qe={class:"flex justify-end mt-[36px]"},Je={class:"mt-[20px]"},Oe={class:"text-sm mt-[10px] text-info"},Ke={class:"mt-[20px]"},Xe={class:"mt-[10px] text-right"},Ge=e("div",{class:"text-page-title mb-[20px]"},"历史版本",-1),Qe={key:0,class:"mt-[10px] p-[20px] bg-overlay rounded-md timeline-log-wrap whitespace-pre"},We=["innerHTML"],ht=Y({__name:"authorize",setup(Ye){const A=i(null),y=i(null),F=i(null),h=i(!1),v=i(!1),C=i([]),I=()=>{me().then(({data:s})=>{C.value=s})};I();const m=Z(()=>C.value.length?C.value[0]:null),S=s=>{const t=JSON.parse(JSON.stringify(s));return t.slice(0,t.length/2)+t.slice(t.length/2,t.length-1).replace(/./g,"*")},B=()=>{h.value=!0},u=i({company_name:"",site_address:"",auth_code:""}),V=i(!0),w=i(!1),L=()=>{xe().then(s=>{V.value=!1,s.data.data&&s.data.data.length!=0&&(u.value=s.data.data,h.value=!1)}).catch(()=>{V.value=!1,h.value=!1})};L();const g=H({auth_code:"",auth_secret:""}),M=i(),U=H({auth_code:[{required:!0,message:c("authCodePlaceholder"),trigger:"blur"}],auth_secret:[{required:!0,message:c("authSecretPlaceholder"),trigger:"blur"}]}),z=async s=>{w.value||!s||await s.validate(async t=>{t&&(w.value=!0,fe(g).then(()=>{w.value=!1,L()}).catch(()=>{w.value=!1,h.value=!1}))})},R=()=>{window.open("https://www.niucloud.com/app")},b=i("");(()=>{ae().then(s=>{b.value=s.data.version.version})})();const $=()=>{var s;if(!u.value){B();return}(s=A.value)==null||s.open()},q=()=>{var s;if(!u.value){B();return}if(y.value.cloudBuildTask){(s=y.value)==null||s.open();return}oe.confirm(c("cloudBuildTips"),c("warning"),{confirmButtonText:c("confirm"),cancelButtonText:c("cancel"),type:"warning"}).then(()=>{var t;(t=y.value)==null||t.open()})};return(s,t)=>{const d=se,J=P("View"),D=le,O=P("Hide"),K=ne,N=re,j=ie,T=ce,X=de,G=pe,Q=ue,W=_e;return l(),k("div",ge,[V.value?E("",!0):(l(),f(T,{key:0,class:"box-card !border-none",shadow:"never"},{default:a(()=>{var x;return[e("div",ye,[e("div",we,[e("div",ke,[Ce,e("div",Ve,[!n(m)||n(m)&&n(m).version_no==b.value?(l(),f(d,{key:0,class:"text-[#4C4C4C] w-[78px] h-[32px] !bg-transparent",onClick:I},{default:a(()=>[p("检测更新")]),_:1})):(l(),f(d,{key:1,class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:$},{default:a(()=>[p("一键升级")]),_:1})),o(d,{class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:q,loading:(x=y.value)==null?void 0:x.loading},{default:a(()=>[p("云编译")]),_:1},8,["loading"])])]),e("div",be,[Be,e("span",Te,_(b.value),1),!n(m)||n(m)&&n(m).version_no==b.value?(l(),k("em",Ee,"(当前已是最新版本)")):(l(),k("em",Ae,"(最新版本"+_(n(m).version_no)+")",1))])]),e("div",Fe,[e("div",Ie,[e("div",Le,[Me,e("span",Re,_(u.value.company_name||"--"),1)]),e("div",De,[e("span",Ne,[p("授权域名"),e("em",je,_(u.value.site_address||"--"),1)]),e("span",He,[Pe,e("em",Se,_(u.value.auth_code?v.value?u.value.auth_code:S(u.value.auth_code):"--"),1),v.value?(l(),f(D,{key:1,onClick:t[1]||(t[1]=r=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:a(()=>[o(O)]),_:1})):(l(),f(D,{key:0,onClick:t[0]||(t[0]=r=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:a(()=>[o(J)]),_:1}))])])]),e("div",Ue,[o(d,{class:"w-[154px] !h-[48px] mt-[8px]",type:"primary",onClick:B},{default:a(()=>[p("授权码认证")]),_:1}),o(K,{ref_key:"getAuthCodeDialog",ref:F,placement:"bottom-start",width:478,trigger:"click",class:"mt-[8px]"},{reference:a(()=>[o(d,{class:"w-[154px] !h-[48px] mt-[8px] !text-[var(--el-color-primary)] hover:!text-[var(--el-color-primary)] !bg-transparent",plain:"",type:"primary"},{default:a(()=>[p("如何获取授权码?")]),_:1})]),default:a(()=>[e("div",ze,[$e,e("div",qe,[o(d,{class:"w-[182px] !h-[48px]",plain:"",onClick:R},{default:a(()=>[p("去应用市场逛逛")]),_:1}),o(d,{class:"w-[100px] !h-[48px]",plain:"",onClick:t[2]||(t[2]=r=>F.value.hide())},{default:a(()=>[p("关闭")]),_:1})])])]),_:1},512)]),o(G,{modelValue:h.value,"onUpdate:modelValue":t[6]||(t[6]=r=>h.value=r),title:"授权码认证",width:"400px"},{default:a(()=>[o(X,{model:g,"label-width":"0",ref_key:"formRef",ref:M,rules:U,class:"page-form"},{default:a(()=>[o(T,{class:"box-card !border-none",shadow:"never"},{default:a(()=>[o(j,{prop:"auth_code"},{default:a(()=>[o(N,{modelValue:g.auth_code,"onUpdate:modelValue":t[3]||(t[3]=r=>g.auth_code=r),modelModifiers:{trim:!0},placeholder:n(c)("authCodePlaceholder"),class:"input-width",clearable:"",size:"large"},null,8,["modelValue","placeholder"])]),_:1}),e("div",Je,[o(j,{prop:"auth_secret"},{default:a(()=>[o(N,{modelValue:g.auth_secret,"onUpdate:modelValue":t[4]||(t[4]=r=>g.auth_secret=r),modelModifiers:{trim:!0},clearable:"",placeholder:n(c)("authSecretPlaceholder"),class:"input-width",size:"large"},null,8,["modelValue","placeholder"])]),_:1})]),e("div",Oe,_(n(c)("authInfoTips")),1),e("div",Ke,[o(d,{type:"primary",class:"w-full",size:"large",loading:w.value,onClick:t[5]||(t[5]=r=>z(M.value))},{default:a(()=>[p(_(n(c)("confirm")),1)]),_:1},8,["loading"])]),e("div",Xe,[o(d,{type:"primary",link:"",onClick:R},{default:a(()=>[p(_(n(c)("notHaveAuth")),1)]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])])]}),_:1})),V.value?E("",!0):(l(),f(T,{key:1,class:"box-card !border-none",shadow:"never"},{default:a(()=>[Ge,o(W,null,{default:a(()=>[(l(!0),k(ee,null,te(C.value,(x,r)=>(l(),f(Q,{timestamp:x.release_time+" 版本："+x.version_no,type:"primary",hollow:!0,placement:"top",key:r},{default:a(()=>[x.upgrade_log?(l(),k("div",Qe,[e("div",{innerHTML:x.upgrade_log},null,8,We)])):E("",!0)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})),o(he,{ref_key:"upgradeRef",ref:A},null,512),o(ve,{ref_key:"cloudBuildRef",ref:y},null,512)])}}});export{ht as default};

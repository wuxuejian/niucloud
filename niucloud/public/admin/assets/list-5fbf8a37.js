import{d as Q,x as W,r as k,n as X,f as Z,h as p,c as h,e as o,w as i,a as u,t as n,u as l,i as m,q as t,F as S,Q as C,s as v,P as ee,A as ae,B as te,cJ as U,j as B,R as le,_ as oe,E as se,J as ie,K as re,ak as ne,aI as pe,da as de,L as ue,a0 as me,aa as ce,aq as _e,ac as fe,T as ge,U as he}from"./index-ae2d9b78.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                *//* empty css                       *//* empty css                  */import"./el-form-item-4ed993c7.js";import{_ as ve}from"./site_logo-5ed68b79.js";import{i as be,s as ye,t as xe,v as ke,w as we,x as Pe}from"./site-6efacd4c.js";import{_ as Se}from"./edit-site.vue_vue_type_script_setup_true_lang-d18cff46.js";import{g as Ce}from"./addon-36ff97ba.js";import{_ as Ve}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                */import"./member_head-a897263d.js";import"./user-a55a9e95.js";const De={class:"main-container"},Ee={class:"flex justify-between items-center"},Ie={class:"text-page-title"},Te={class:"mt-[20px]"},Le={class:"flex items-center"},$e=["src"],Fe={key:1,class:"w-[50px] h-[50px] mr-[10px]",src:ve,alt:""},Ue={class:"flex flex flex-col"},Be={class:"flex items-center"},Ne={class:"flex flex flex-col"},Ye={key:0},je={key:1},ze={class:"mt-[16px] flex justify-end"},Me=Q({__name:"list",setup(Re){const V=W(),N=V.meta.title,b=k({all:[]}),D=k([]),s=X({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{keywords:"",group_id:"",app:"all",status:"",site_domain:"",create_time:[],expire_time:[]}});s.searchParam.status=V.query.id||"",(async()=>{const r=await(await be({})).data;b.value.all=r,r.forEach((a,d)=>{b.value[a.app]||(b.value[a.app]=[]),b.value[a.app].push(a)})})(),(async()=>{D.value=await(await ye()).data})();const E=k(),Y=r=>{r&&(r.resetFields(),_())},j=()=>{s.searchParam.group_id=""},I=k([]);Ce().then(({data:r})=>{I.value=r}).catch();const _=(r=1)=>{s.loading=!0,s.page=r,s.searchParam.app=s.searchParam.app=="all"?"":s.searchParam.app,xe({page:s.page,limit:s.limit,...s.searchParam}).then(a=>{s.loading=!1,s.data=a.data.data,s.total=a.data.total}).catch(()=>{s.loading=!1})};_();const z=Z(),x=k(null),M=r=>{x.value.setFormData(),x.value.showDialog=!0},R=r=>{z.push({path:"/admin/site/info",query:{id:r.site_id}})},q=r=>{x.value.setFormData(r),x.value.showDialog=!0},T=(r=0)=>{if(window.localStorage.setItem("site.token",U()),window.localStorage.setItem("site.comparisonTokenStorage",U()),window.localStorage.setItem("site.userinfo",JSON.stringify(B().userInfo)),r){const a=B().userInfo;if(a.is_super_admin!=null&&!a.is_super_admin&&(a.site_ids||[]).indexOf(r)==-1){le({message:t("noPermission"),type:"warning"});return}window.localStorage.setItem("site.siteId",r),window.localStorage.setItem("site.comparisonSiteIdStorage",r),window.open(`${location.origin}/site/`)}else window.open(`${location.origin}/home/index`)},H=(r,a)=>{r==1&&ke({site_id:a}).then(d=>{_()}),r==3&&we({site_id:a}).then(d=>{_()})},O=r=>{oe.confirm(t("siteDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{Pe(r.site_id).then(a=>{_()}).catch(()=>{})})};return(r,a)=>{const d=se,L=ie,g=re,y=ne,w=pe,$=de,A=ue,F=me,f=ce,P=_e,G=fe,J=ge,K=he;return p(),h("div",De,[o(F,{class:"box-card !border-none",shadow:"never"},{default:i(()=>[u("div",Ee,[u("span",Ie,n(l(N)),1),u("div",null,[o(d,{type:"primary",class:"w-[100px]",onClick:M},{default:i(()=>[m(n(l(t)("addSite")),1)]),_:1}),o(d,{type:"default",class:"w-[100px]",onClick:a[0]||(a[0]=e=>T())},{default:i(()=>[m(n(l(t)("toSite")),1)]),_:1})])]),o(F,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:i(()=>[o(A,{inline:!0,model:s.searchParam,ref_key:"searchFormRef",ref:E},{default:i(()=>[o(g,{label:l(t)("siteName"),prop:"keywords"},{default:i(()=>[o(L,{modelValue:s.searchParam.keywords,"onUpdate:modelValue":a[1]||(a[1]=e=>s.searchParam.keywords=e),placeholder:l(t)("siteNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("siteDomain"),prop:"site_domain"},{default:i(()=>[o(L,{modelValue:s.searchParam.site_domain,"onUpdate:modelValue":a[2]||(a[2]=e=>s.searchParam.site_domain=e),placeholder:l(t)("siteDomainPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("app"),prop:"app_id"},{default:i(()=>[o(w,{modelValue:s.searchParam.app,"onUpdate:modelValue":a[3]||(a[3]=e=>s.searchParam.app=e),clearable:"",onChange:j,placeholder:l(t)("appIdPlaceholder"),class:"input-width"},{default:i(()=>[o(y,{label:l(t)("selectPlaceholder"),value:"all"},null,8,["label"]),(p(!0),h(S,null,C(Object.values(I.value),(e,c)=>(p(),v(y,{label:e.title,value:e.key,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("groupId"),prop:"group_id"},{default:i(()=>[o(w,{modelValue:s.searchParam.group_id,"onUpdate:modelValue":a[4]||(a[4]=e=>s.searchParam.group_id=e),clearable:"",placeholder:l(t)("groupIdPlaceholder"),class:"input-width"},{default:i(()=>[o(y,{label:l(t)("selectPlaceholder"),value:""},null,8,["label"]),(p(!0),h(S,null,C(b.value.all,(e,c)=>(p(),v(y,{label:e.group_name,value:e.group_id,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("status"),prop:"status"},{default:i(()=>[o(w,{modelValue:s.searchParam.status,"onUpdate:modelValue":a[5]||(a[5]=e=>s.searchParam.status=e),clearable:"",placeholder:l(t)("groupIdPlaceholder"),class:"input-width"},{default:i(()=>[o(y,{label:l(t)("selectPlaceholder"),value:""},null,8,["label"]),(p(!0),h(S,null,C(D.value,(e,c)=>(p(),v(y,{label:e,value:c,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("createTime"),prop:"create_time"},{default:i(()=>[o($,{modelValue:s.searchParam.create_time,"onUpdate:modelValue":a[6]||(a[6]=e=>s.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":l(t)("startDate"),"end-placeholder":l(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),o(g,{label:l(t)("expireTime"),prop:"expire_time"},{default:i(()=>[o($,{modelValue:s.searchParam.expire_time,"onUpdate:modelValue":a[7]||(a[7]=e=>s.searchParam.expire_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":l(t)("startDate"),"end-placeholder":l(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),o(g,null,{default:i(()=>[o(d,{type:"primary",onClick:a[8]||(a[8]=e=>_())},{default:i(()=>[m(n(l(t)("search")),1)]),_:1}),o(d,{onClick:a[9]||(a[9]=e=>Y(E.value))},{default:i(()=>[m(n(l(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),u("div",Te,[ee((p(),v(G,{data:s.data,size:"large"},{empty:i(()=>[u("span",null,n(s.loading?"":l(t)("emptyData")),1)]),default:i(()=>[o(f,{prop:"site_id",label:l(t)("siteId"),width:"100","show-overflow-tooltip":!0},null,8,["label"]),o(f,{label:l(t)("siteInfo"),width:"300",align:"left"},{default:i(({row:e})=>[u("div",Le,[e.logo?(p(),h("img",{key:0,class:"w-[50px] h-[50px] mr-[10px]",src:l(ae)(e.logo),alt:""},null,8,$e)):(p(),h("img",Fe)),u("div",Ue,[u("span",null,n(e.site_name||""),1)])])]),_:1},8,["label"]),o(f,{label:l(t)("manager"),width:"150",align:"left"},{default:i(({row:e})=>[u("div",Be,[u("div",Ne,[u("span",null,n(e.admin.username||""),1)])])]),_:1},8,["label"]),o(f,{prop:"group_name",label:l(t)("groupId"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),o(f,{prop:"site_domain",label:l(t)("siteDomain"),width:"150","show-overflow-tooltip":!0},null,8,["label"]),o(f,{prop:"create_time",label:l(t)("createTime"),width:"250","show-overflow-tooltip":!0},null,8,["label"]),o(f,{prop:"expire_time",label:l(t)("expireTime"),width:"250","show-overflow-tooltip":!0},{default:i(({row:e})=>[e.expire_time==0?(p(),h("div",Ye,"永久")):(p(),h("div",je,n(e.expire_time),1))]),_:1},8,["label"]),o(f,{label:l(t)("status"),width:"100",align:"center"},{default:i(({row:e})=>[e.status==1?(p(),v(P,{key:0,class:"ml-2",type:"success"},{default:i(()=>[m(n(e.status_name),1)]),_:2},1024)):e.status==3?(p(),v(P,{key:1,class:"ml-2",type:"error"},{default:i(()=>[m(n(e.status_name),1)]),_:2},1024)):(p(),v(P,{key:2,class:"ml-2",type:"error"},{default:i(()=>[m(n(e.status_name),1)]),_:2},1024))]),_:1},8,["label"]),o(f,{label:l(t)("operation"),"min-width":"210",align:"right",fixed:"right"},{default:i(({row:e})=>[e.status==1||e.status==3?(p(),v(d,{key:0,type:"primary",link:"",onClick:c=>H(e.status,e.site_id)},{default:i(()=>[m(n(e.status==1?l(t)("closeTxt"):l(t)("openTxt")),1)]),_:2},1032,["onClick"])):te("",!0),o(d,{type:"primary",link:"",onClick:c=>q(e)},{default:i(()=>[m(n(l(t)("edit")),1)]),_:2},1032,["onClick"]),o(d,{type:"primary",link:"",onClick:c=>O(e)},{default:i(()=>[m(n(l(t)("delete")),1)]),_:2},1032,["onClick"]),o(d,{type:"primary",link:"",onClick:c=>R(e)},{default:i(()=>[m(n(l(t)("info")),1)]),_:2},1032,["onClick"]),o(d,{type:"primary",link:"",onClick:c=>T(e.site_id)},{default:i(()=>[m(n(l(t)("toSite")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[K,s.loading]]),u("div",ze,[o(J,{"current-page":s.page,"onUpdate:current-page":a[10]||(a[10]=e=>s.page=e),"page-size":s.limit,"onUpdate:page-size":a[11]||(a[11]=e=>s.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:a[12]||(a[12]=e=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])])]),_:1}),o(Se,{ref_key:"addSiteDialog",ref:x,onComplete:a[13]||(a[13]=e=>_())},null,512)])}}});const ya=Ve(Me,[["__scopeId","data-v-294734ef"]]);export{ya as default};

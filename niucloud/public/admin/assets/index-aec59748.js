import{d as me,O as ue,f as fe,r as m,n as he,v as xe,a8 as P,h as u,c as L,e as a,w as e,a as s,t as c,u as o,N as t,i as f,F as ve,G as ge,I as y,y as M,B as be,aa as q,a2 as ye,R as ke,E as we,ao as Ce,ap as Ee,aO as Te,av as Fe,aT as Ne,_ as Ve,Z as De,$ as Pe,ac as Se,ak as Be,am as Ae,a3 as $e,aP as Le,a7 as je,aN as Ie,as as Ge,ad as Oe,a4 as ze,p as Re,g as Ue}from"./index-022827e1.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                    *//* empty css                *//* empty css                    *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                     *//* empty css                *//* empty css                  */import{s as Me,g as qe,t as Ke,q as Ze,r as He,u as Je}from"./tools-1ceab74e.js";import{_ as Qe}from"./add-table.vue_vue_type_script_setup_true_lang-f0790d5e.js";import{_ as We}from"./_plugin-vue_export-helper-c27b6911.js";const h=C=>(Re("data-v-74d39f04"),C=C(),Ue(),C),Xe={class:"main-container"},Ye={class:"flex justify-between items-center mb-[10px]"},et={class:"text-page-title"},tt=h(()=>s("div",{class:"w-[24px] h-[24px] text-[#fff] bg-[#778aa3] text-center leading-[24px] rounded-full"}," 1",-1)),at={class:"text-[14px] text-[#303133] font-[700]"},lt={class:"text-[#999]"},ot={class:"mt-[20px] mb-[40px] h-[32px]"},nt=h(()=>s("div",{class:"w-[24px] h-[24px] text-[#fff] bg-[#778aa3] text-center leading-[24px] rounded-full"}," 2",-1)),st={class:"text-[14px] text-[#303133] font-[700]"},it={class:"text-[#999]"},dt=h(()=>s("div",{class:"mt-[20px] mb-[40px] h-[32px]"},null,-1)),ct=h(()=>s("div",{class:"w-[24px] h-[24px] text-[#fff] bg-[#778aa3] text-center leading-[24px] rounded-full"}," 3",-1)),rt={class:"text-[14px] text-[#303133] font-[700]"},pt={class:"text-[#999]"},_t=h(()=>s("div",{class:"mt-[20px] mb-[40px] h-[32px]"},null,-1)),mt=h(()=>s("div",{class:"w-[24px] h-[24px] text-[#fff] bg-[#778aa3] text-center leading-[24px] rounded-full"}," 4",-1)),ut={class:"text-[14px] text-[#303133] font-[700]"},ft={class:"text-[#999]"},ht=h(()=>s("div",{class:"mt-[20px] mb-[40px] h-[32px]"},null,-1)),xt=h(()=>s("div",{class:"w-[24px] h-[24px] text-[#fff] bg-[#778aa3] text-center leading-[24px] rounded-full"}," 5",-1)),vt={class:"text-[14px] text-[#303133] font-[700]"},gt={class:"text-[#999]"},bt=h(()=>s("div",{class:"mt-[20px] mb-[40px] h-[32px]"},null,-1)),yt={class:"mt-[16px] flex justify-end"},kt={class:"flex h-[50vh]"},wt={class:"flex items-center"},Ct={class:"pl-[5px]"},Et={class:"ml-[20px]",style:{width:"calc(100% - 285px)"}},Tt=me({__name:"index",setup(C){const K=ue().meta.title,Z=fe(),S=m("codeGeneration"),i=he({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{table_name:"",table_content:"",addon_name:""}}),j=m(),H=d=>{d&&(d.resetFields(),v())};xe(()=>{window.codeActiveName&&(S.value=window.codeActiveName+"",window.codeActiveName=null),v()});const v=(d=1)=>{i.loading=!0,i.page=d,Me({page:i.page,limit:i.limit,...i.searchParam}).then(l=>{i.loading=!1,i.data=l.data.data,i.total=l.data.total}).catch(()=>{i.loading=!1})},I=m([]),J=d=>{qe({search:d}).then(l=>{I.value=l.data})},B=m(null),Q=()=>{B.value.setFormData(),B.value.showDialog=!0},W=d=>{q.confirm(t("codeDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{Ke(d).then(()=>{v()}).catch(()=>{})})},X=d=>{Z.push("/tools/code/edit?id="+d.id)},Y=d=>{Ze({id:d}).then(l=>{i.loading=!1,q.confirm(l.msg!="2"?t("saveAndSyncText"):t("saveAndSyncText1"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel")}).then(()=>{G(d,3)}).catch(()=>{})}).catch(()=>{i.loading=!1})},G=(d,l)=>{i.loading=!0,He({id:d,generate_type:l}).then(r=>{ye({type:"success",message:"操作成功"}),l!=3?(i.loading=!1,window.open(ke(r.data.file),"_blank")):v()}).catch(()=>{i.loading=!1})},A=m([]),$=m(!1),E=m([]),T=m(!1),F=m(""),N=m(""),ee=d=>{$.value=!0,T.value=!0,F.value="",E.value=[],N.value="",Je(d).then(l=>{A.value=l.data,E.value=ae(l.data.map(r=>r.file_dir+r.name)),F.value=A.value[0].content,T.value=!1}).catch(()=>{T.value=!1})},te=d=>{A.value.forEach(l=>{d.path===l.file_dir+l.name&&(F.value=l.content)})},ae=d=>{const l=[];if(Array.isArray(d))for(let _=0;_<d.length;++_){const V=d[_].split("/");let g=l;for(let x=0;x<V.length;++x){const k=V[x];let p=null;for(var r=0;r<g.length;++r){const D=g[r];if(D.name===k){p=D;break}}p||(p={name:k,path:k.indexOf(".")<0?"":d[_],key:"k"+_+x+r},k.indexOf(".")<0&&(p.children=[]),p.path===d[0]&&(N.value=p.key),g.push(p)),p.children&&(g=p.children)}}return l};return(d,l)=>{const r=we,_=Ce,V=Ee,g=Te,x=Fe,k=Ne,p=Ve,D=De,le=Pe,O=Se,w=Be,oe=Ae,ne=$e,se=Le,ie=P("Folder"),de=P("FolderOpened"),z=je,ce=P("Document"),re=Ie,R=Ge,pe=P("highlightjs"),_e=Oe,U=ze;return u(),L("div",Xe,[a(O,{class:"box-card !border-none",shadow:"never"},{default:e(()=>[s("div",Ye,[s("span",et,c(o(K)),1)]),a(se,{modelValue:S.value,"onUpdate:modelValue":l[7]||(l[7]=n=>S.value=n),class:"demo-tabs"},{default:e(()=>[a(g,{label:o(t)("codeGeneration"),name:"codeGeneration"},{default:e(()=>[a(V,{direction:"vertical"},{default:e(()=>[a(_,null,{icon:e(()=>[tt]),title:e(()=>[s("p",at,c(o(t)("step1")),1)]),description:e(()=>[s("span",lt,c(o(t)("describe1")),1),s("div",ot,[a(r,{type:"primary",class:"w-[100px]",onClick:Q},{default:e(()=>[f(c(o(t)("btn1")),1)]),_:1})])]),_:1}),a(_,null,{icon:e(()=>[nt]),title:e(()=>[s("p",st,c(o(t)("step2")),1)]),description:e(()=>[s("span",it,c(o(t)("describe2")),1),dt]),_:1}),a(_,null,{icon:e(()=>[ct]),title:e(()=>[s("p",rt,c(o(t)("step3")),1)]),description:e(()=>[s("span",pt,c(o(t)("describe3")),1),_t]),_:1}),a(_,null,{icon:e(()=>[mt]),title:e(()=>[s("p",ut,c(o(t)("step4")),1)]),description:e(()=>[s("span",ft,c(o(t)("describe4")),1),ht]),_:1}),a(_,null,{icon:e(()=>[xt]),title:e(()=>[s("p",vt,c(o(t)("step5")),1)]),description:e(()=>[s("span",gt,c(o(t)("describe5")),1),bt]),_:1})]),_:1})]),_:1},8,["label"]),a(g,{label:o(t)("codeList"),name:"codeList"},{default:e(()=>[a(O,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:e(()=>[a(le,{inline:!0,model:i.searchParam,ref_key:"searchFormRef",ref:j},{default:e(()=>[a(p,{label:o(t)("addonName"),prop:"addon_name"},{default:e(()=>[a(k,{modelValue:i.searchParam.addon_name,"onUpdate:modelValue":l[0]||(l[0]=n=>i.searchParam.addon_name=n),placeholder:"Select",filterable:"",remote:"",clearable:"","remote-method":J},{default:e(()=>[a(x,{label:"全部",value:""}),a(x,{label:"系统",value:"2"}),(u(!0),L(ve,null,ge(I.value,n=>(u(),y(x,{label:n.title,value:n.key,key:n.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(p,{label:o(t)("tableName"),prop:"table_name"},{default:e(()=>[a(D,{modelValue:i.searchParam.table_name,"onUpdate:modelValue":l[1]||(l[1]=n=>i.searchParam.table_name=n),placeholder:o(t)("tableNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,null,{default:e(()=>[a(r,{type:"primary",onClick:l[2]||(l[2]=n=>v())},{default:e(()=>[f(c(o(t)("search")),1)]),_:1}),a(r,{onClick:l[3]||(l[3]=n=>H(j.value))},{default:e(()=>[f(c(o(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s("div",null,[M((u(),y(oe,{data:i.data,size:"large"},{empty:e(()=>[s("span",null,c(i.loading?"":o(t)("emptyData")),1)]),default:e(()=>[a(w,{prop:"table_name","show-overflow-tooltip":!0,label:o(t)("tableName"),"min-width":"120"},null,8,["label"]),a(w,{prop:"title","show-overflow-tooltip":!0,label:o(t)("addonName"),"min-width":"120"},null,8,["label"]),a(w,{prop:"table_content","show-overflow-tooltip":!0,label:o(t)("tableContent"),"min-width":"120"},null,8,["label"]),a(w,{prop:"edit_type",label:o(t)("editType"),"min-width":"150",align:"center"},{default:e(({row:n})=>[f(c(n.edit_type==1?o(t)("popup"):o(t)("page")),1)]),_:1},8,["label"]),a(w,{label:o(t)("createTime"),"min-width":"180",align:"center"},{default:e(({row:n})=>[f(c(n.create_time||""),1)]),_:1},8,["label"]),a(w,{label:o(t)("operation"),fixed:"right",align:"right",width:"330"},{default:e(({row:n})=>[a(r,{type:"primary",link:"",onClick:b=>X(n)},{default:e(()=>[f(c(o(t)("edit")),1)]),_:2},1032,["onClick"]),a(r,{type:"primary",link:"",onClick:b=>ee(n.id)},{default:e(()=>[f(c(o(t)("preview")),1)]),_:2},1032,["onClick"]),a(r,{type:"primary",link:"",onClick:b=>Y(n.id)},{default:e(()=>[f(c(o(t)("saveAndSync")),1)]),_:2},1032,["onClick"]),a(r,{type:"primary",link:"",onClick:b=>G(n.id,2)},{default:e(()=>[f(c(o(t)("download")),1)]),_:2},1032,["onClick"]),a(r,{type:"primary",link:"",onClick:b=>W(n.id)},{default:e(()=>[f(c(o(t)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[U,i.loading]]),s("div",yt,[a(ne,{"current-page":i.page,"onUpdate:current-page":l[4]||(l[4]=n=>i.page=n),"page-size":i.limit,"onUpdate:page-size":l[5]||(l[5]=n=>i.limit=n),layout:"total, sizes, prev, pager, next, jumper",total:i.total,onSizeChange:l[6]||(l[6]=n=>v()),onCurrentChange:v},null,8,["current-page","page-size","total"])])])]),_:1},8,["label"])]),_:1},8,["modelValue"]),a(Qe,{ref_key:"addCodeDialog",ref:B},null,512),a(_e,{modelValue:$.value,"onUpdate:modelValue":l[8]||(l[8]=n=>$.value=n),class:"dialog-visible",width:"70%",title:"代码预览"},{default:e(()=>[M((u(),L("div",kt,[a(R,{class:"h-[100%] w-[270px]"},{default:e(()=>[E.value.length&&N.value!=""?(u(),y(re,{key:0,data:E.value,props:{label:"name",value:"key"},"node-key":"key","current-node-key":N.value,"expand-on-click-node":!1,"highlight-current":"","default-expand-all":"",ref:"treeRef",onNodeClick:te},{default:e(({node:n,data:b})=>[s("div",wt,[b.children?(u(),y(z,{key:0},{default:e(()=>[n.expanded?(u(),y(de,{key:1})):(u(),y(ie,{key:0}))]),_:2},1024)):(u(),y(z,{key:1},{default:e(()=>[a(ce)]),_:1})),s("span",Ct,c(b.name),1)])]),_:1},8,["data","current-node-key"])):be("",!0)]),_:1}),s("div",Et,[a(R,{class:"h-[100%] w-[100%]"},{default:e(()=>[a(pe,{autodetect:"",class:"h-[100%]",code:F.value},null,8,["code"])]),_:1})])])),[[U,T.value]])]),_:1},8,["modelValue"])]),_:1})])}}});const Xt=We(Tt,[["__scopeId","data-v-74d39f04"]]);export{Xt as default};

import{d as W,r as m,n as X,q as T,N as e,a0 as Y,h as n,I as f,w as s,a as c,e as r,i as b,t as _,u as t,y as N,c as g,F as y,G as E,R as H,z as K,W as Q,X as Z,as as ee,aE as le,a1 as ae,aI as oe,cJ as te,Y as re,E as se,aa as ie,$ as de}from"./index-efa627c5.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                *//* empty css               *//* empty css                  *//* empty css                  */import{_ as ne}from"./member_head-a897263d.js";import{i as ue,j as pe,k as me,m as ce}from"./site-1f276a5c.js";import{a as _e}from"./user-464ec031.js";import{g as fe}from"./addon-beab9ae6.js";const ge={key:0},we={class:"flex items-center"},ve={class:"flex items-center"},be={key:1,src:ne,alt:"",class:"mr-[10px] w-[24px]"},he={key:1},Ve={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},xe={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},Pe={class:"dialog-footer"},ze=W({__name:"edit-site",emits:["complete"],setup(ye,{expose:S,emit:q}){const w=m(!1),p=m(!0),h=m([]),D=m([]),L=m([]);_e({}).then(({data:d})=>{D.value=d}).catch();const V=new Date;V.setTime(V.getTime()+3600*1e3*2*360);const k={site_id:"",site_name:"",real_name:"",uid:"",username:"",password:"",confirm_password:"",expire_time:V,site_domain:"",group_id:""},a=X({...k}),I=m();(async()=>{h.value=await(await ue()).data})();const A=m([]);fe().then(({data:d})=>{A.value=d}).catch();const F=async(d=null)=>{if(p.value=!0,Object.assign(a,k),d){const o=await(await pe(d.site_id)).data;L.value=o,Object.keys(a).forEach(i=>{o[i]!=null&&(a[i]=o[i])})}p.value=!1},B=T(()=>({site_name:[{required:!0,message:e("siteNamePlaceholder"),trigger:"blur"}],group_id:[{required:!0,message:e("groupIdPlaceholder"),trigger:"blur"}],uid:[{validator:(d,o,i)=>{a.uid===""?i(new Error(e("managerPlaceholder"))):i()},trigger:"blur"}],username:[{required:a.uid==0,message:e("usernamePlaceholder"),trigger:"blur"}],password:[{required:a.uid==0,message:e("passwordPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:e("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:a.uid==0,message:e("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(d,o,i)=>{a.uid==0&&o!=a.password?i(new Error(e("confirmPasswordError"))):i()},trigger:"blur"}],expire_time:[{required:!0,message:e("expireTimePlaceholder"),trigger:"blur"}]})),C=T(()=>p.value?"":a.site_id?e("editSite"):e("addSite")),R=async d=>{p.value||!d||await d.validate(async o=>{if(o){p.value=!0;const i=a;(i.site_id?me:ce)(i).then(v=>{p.value=!1,w.value=!1,q("complete")}).catch(()=>{p.value=!1})}})};return S({showDialog:w,setFormData:F,loading:p}),(d,o)=>{const i=Q,u=Z,v=ee,x=le,G=Y("Plus"),j=ae,O=oe,$=te,z=re,U=se,M=ie,J=de;return n(),f(M,{modelValue:w.value,"onUpdate:modelValue":o[11]||(o[11]=l=>w.value=l),title:t(C),width:"500px","destroy-on-close":!0},{footer:s(()=>[c("span",Pe,[r(U,{onClick:o[9]||(o[9]=l=>w.value=!1)},{default:s(()=>[b(_(t(e)("cancel")),1)]),_:1}),r(U,{type:"primary",loading:p.value,onClick:o[10]||(o[10]=l=>R(I.value))},{default:s(()=>[b(_(t(e)("confirm")),1)]),_:1},8,["loading"])])]),default:s(()=>[N((n(),f(z,{model:a,"label-width":"90px",ref_key:"formRef",ref:I,rules:t(B),class:"page-form"},{default:s(()=>[a.site_id==0?(n(),g("div",ge,[r(u,{label:t(e)("siteName"),prop:"site_name"},{default:s(()=>[r(i,{modelValue:a.site_name,"onUpdate:modelValue":o[0]||(o[0]=l=>a.site_name=l),clearable:"",placeholder:t(e)("siteNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:t(e)("groupId"),prop:"group_id"},{default:s(()=>[r(x,{modelValue:a.group_id,"onUpdate:modelValue":o[1]||(o[1]=l=>a.group_id=l),clearable:"",placeholder:t(e)("groupIdPlaceholder"),class:"input-width"},{default:s(()=>[(n(!0),g(y,null,E(h.value,(l,P)=>(n(),f(v,{label:l.group_name,value:l.group_id,key:P},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:t(e)("manager"),prop:"uid"},{default:s(()=>[r(x,{modelValue:a.uid,"onUpdate:modelValue":o[2]||(o[2]=l=>a.uid=l),placeholder:t(e)("managerPlaceholder"),class:"input-width",filterable:"",autocomplete:"off"},{default:s(()=>[r(v,{label:t(e)("newAddManager"),value:0},{default:s(()=>[c("div",we,[r(j,{class:"mr-[10px]"},{default:s(()=>[r(G)]),_:1}),b(" "+_(t(e)("newAddManager")),1)])]),_:1},8,["label"]),(n(!0),g(y,null,E(D.value,l=>(n(),f(v,{key:l.uid,label:l.username,value:l.uid},{default:s(()=>[c("div",ve,[l.head_img?(n(),f(O,{key:0,src:t(H)(l.head_img),size:"small",class:"mr-[10px]"},null,8,["src"])):(n(),g("img",be)),b(" "+_(l.username),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),N(c("div",null,[r(u,{label:t(e)("username"),prop:"username"},{default:s(()=>[r(i,{modelValue:a.username,"onUpdate:modelValue":o[3]||(o[3]=l=>a.username=l),clearable:"",placeholder:t(e)("usernamePlaceholder"),class:"input-width",autocomplete:"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:t(e)("password"),prop:"password"},{default:s(()=>[r(i,{modelValue:a.password,"onUpdate:modelValue":o[4]||(o[4]=l=>a.password=l),clearable:"",placeholder:t(e)("passwordPlaceholder"),class:"input-width","show-password":!0,type:"password",autocomplete:"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:t(e)("confirmPassword"),prop:"confirm_password"},{default:s(()=>[r(i,{modelValue:a.confirm_password,"onUpdate:modelValue":o[5]||(o[5]=l=>a.confirm_password=l),placeholder:t(e)("confirmPasswordPlaceholder"),type:"password","show-password":!0,clearable:"",class:"input-width",autocomplete:"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],512),[[K,a.uid===0]])])):(n(),g("div",he,[r(u,{label:t(e)("siteName")},{default:s(()=>[b(_(a.site_name),1)]),_:1},8,["label"]),r(u,{label:t(e)("groupId"),prop:"group_id"},{default:s(()=>[r(x,{modelValue:a.group_id,"onUpdate:modelValue":o[6]||(o[6]=l=>a.group_id=l),clearable:"",placeholder:t(e)("groupIdPlaceholder"),class:"input-width"},{default:s(()=>[(n(!0),g(y,null,E(h.value,(l,P)=>(n(),f(v,{label:l.group_name,value:l.group_id,key:P},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])])),r(u,{label:t(e)("siteDomain"),prop:"site_domain"},{default:s(()=>[r(i,{modelValue:a.site_domain,"onUpdate:modelValue":o[7]||(o[7]=l=>a.site_domain=l),clearable:"",placeholder:t(e)("siteDomainPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"]),c("div",null,[c("p",Ve,_(t(e)("siteDomainTips")),1),c("p",xe,_(t(e)("siteDomainTipsTwo")),1)])]),_:1},8,["label"]),r(u,{label:t(e)("expireTime"),prop:"expire_time",class:"input-width"},{default:s(()=>[r($,{class:"flex-1 !flex",modelValue:a.expire_time,"onUpdate:modelValue":o[8]||(o[8]=l=>a.expire_time=l),clearable:"",type:"datetime",placeholder:t(e)("expireTimePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[J,p.value]])]),_:1},8,["modelValue","title"])}}});export{ze as _};

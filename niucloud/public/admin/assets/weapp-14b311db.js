import{d as S,x as J,n as E,r as v,l as K,q as t,h as y,c as M,e as l,w as r,a as d,t as m,u as i,i as g,P as C,s as k,_ as W,E as A,aa as G,ac as H,T as O,a0 as Q,J as X,K as Y,L as Z,a1 as ee,U as te}from"./index-ae2d9b78.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                */import{_ as ae}from"./index.vue_vue_type_style_index_0_lang-6cd5bc0b.js";import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                  */import{h as oe,i as le,j as ne,k as ie}from"./weapp-e840c1ab.js";import{_ as se}from"./cron-info.vue_vue_type_script_setup_true_lang-3a5dec9e.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                    */const pe={class:"main-container"},de={class:"flex justify-between items-center"},me={class:"text-page-title"},ue={class:"mt-[10px]"},ce={class:"mt-[16px] flex justify-end"},_e={class:"dialog-footer"},fe=S({__name:"weapp",setup(ve){const D=J().meta.title,a=E({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",last_time:""}}),u=(s=1)=>{a.loading=!0,a.page=s,oe({page:a.page,limit:a.limit,...a.searchParam}).then(e=>{a.loading=!1,a.data=e.data.data,a.total=e.data.total}).catch(()=>{a.loading=!1})};u();const c=v(!1),o=E({...{id:0,desc:"",path:"",version:"",type:"weapp"}}),b=v(),T=()=>{o.id=0,o.desc="",o.path="",o.version="",c.value=!0},B=K(()=>({version:[{required:!0,message:t("versionPlaceholder"),trigger:"blur"}],path:[{required:!0,validator:P,trigger:"blur"}]})),P=(s,e,p)=>o.path==""?p(new Error(t("filePlaceholder"))):p(),_=v(!1),U=async s=>{_.value||!s||await s.validate(async e=>{if(e){_.value=!0;const p=o;(o.id>0?le:ne)(p).then(w=>{_.value=!1,c.value=!1,u()}).catch(()=>{_.value=!1})}})},z=s=>{o.id=s.id,o.desc=s.desc,o.path=s.path,o.version=s.version,c.value=!0},$=s=>{W.confirm(t("weappVersionDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{ie(s).then(()=>{u()}).catch(()=>{})})},j=v(null);return(s,e)=>{const p=A,f=G,w=H,F=O,L=Q,V=X,h=Y,N=ae,R=Z,q=ee,x=te;return y(),M("div",pe,[l(L,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[d("div",de,[d("span",me,m(i(D)),1),l(p,{type:"primary",onClick:T},{default:r(()=>[g(m(i(t)("addVersion")),1)]),_:1})]),d("div",ue,[C((y(),k(w,{data:a.data,size:"large"},{empty:r(()=>[d("span",null,m(a.loading?"":i(t)("emptyData")),1)]),default:r(()=>[l(f,{prop:"version",label:i(t)("version"),"min-width":"150"},null,8,["label"]),l(f,{prop:"create_time",label:i(t)("createTime"),"min-width":"150"},null,8,["label"]),l(f,{label:i(t)("operation"),align:"right",fixed:"right",width:"130"},{default:r(({row:n})=>[l(p,{type:"primary",link:"",onClick:I=>z(n)},{default:r(()=>[g(m(i(t)("edit")),1)]),_:2},1032,["onClick"]),l(p,{type:"primary",link:"",onClick:I=>$(n.id)},{default:r(()=>[g(m(i(t)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[x,a.loading]]),d("div",ce,[l(F,{"current-page":a.page,"onUpdate:current-page":e[0]||(e[0]=n=>a.page=n),"page-size":a.limit,"onUpdate:page-size":e[1]||(e[1]=n=>a.limit=n),layout:"total, sizes, prev, pager, next, jumper",total:a.total,onSizeChange:e[2]||(e[2]=n=>u()),onCurrentChange:u},null,8,["current-page","page-size","total"])])])]),_:1}),l(se,{ref_key:"cronDialog",ref:j,onComplete:a},null,8,["onComplete"]),l(q,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=n=>c.value=n),title:i(t)("editVersion"),width:"550px","destroy-on-close":!0},{footer:r(()=>[d("span",_e,[l(p,{type:"primary",onClick:e[6]||(e[6]=n=>U(b.value))},{default:r(()=>[g(m(i(t)("confirm")),1)]),_:1})])]),default:r(()=>[C((y(),k(R,{model:o,"label-width":"110px",ref_key:"formRef",ref:b,rules:i(B),class:"page-form"},{default:r(()=>[l(h,{label:i(t)("version"),prop:"version"},{default:r(()=>[l(V,{modelValue:o.version,"onUpdate:modelValue":e[3]||(e[3]=n=>o.version=n),placeholder:i(t)("versionPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(h,{label:i(t)("file"),prop:"path"},{default:r(()=>[l(N,{modelValue:o.path,"onUpdate:modelValue":e[4]||(e[4]=n=>o.path=n),class:"input-width",api:"applet/upload"},null,8,["modelValue"])]),_:1},8,["label"]),l(h,{label:i(t)("desc")},{default:r(()=>[l(V,{type:"textarea",modelValue:o.desc,"onUpdate:modelValue":e[5]||(e[5]=n=>o.desc=n),class:"input-width",clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[x,s.loading]])]),_:1},8,["modelValue","title"])])}}});const Ke=re(fe,[["__scopeId","data-v-52a7d633"]]);export{Ke as default};

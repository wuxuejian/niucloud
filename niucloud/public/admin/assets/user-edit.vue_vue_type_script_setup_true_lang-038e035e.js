import{d as T,r as d,q as a,H as x,h as b,s as h,w as r,a as c,e as s,i as w,t as p,u,R as O,c as I,F as j,T as z,B as A,K as H,L as K,au as X,bT as Y,ab as J,ac as Q,M as W,V as Z,E as ee,X as le,Y as ae}from"./index-39857e33.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                     *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                        *//* empty css               *//* empty css                          *//* empty css                 */import{k as oe}from"./site-fb11f4a2.js";import{d as te}from"./user-a7966108.js";const re={class:"max-h-[60vh]"},se={class:"w-full"},ue={class:"dialog-footer"},Pe=T({__name:"user-edit",emits:["complete"],setup(ne,{expose:B,emit:N}){const _=d(!1),m=d(!0),t=d({username:"",password:"",confirm_password:"",create_site_limit:[],group_ids:[]}),v=d({}),P=d(),L=d({username:[{required:!0,message:a("usernamePlaceholder"),trigger:"blur"}],password:[{required:!0,message:a("passwordPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:a("userRealNamePlaceholder"),trigger:"blur"}],confirm_password:[{required:!0,message:a("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(n,e,o)=>{e!=t.value.password?o(new Error(a("confirmPasswordError"))):o()},trigger:"blur"}],create_site_limit:[{validator:(n,e,o)=>{let i=!0;for(let g=0;g<t.value.create_site_limit.length;g++){const f=t.value.create_site_limit[g];if(x.empty(f.num)){o(a("siteNumPlaceholder")),i=!1;break}if(f.num<1){o(a("siteNumCannotLtOne")),i=!1;break}if(x.empty(f.month)){o(a("siteMonthPlaceholder")),i=!1;break}if(f.month<0){o(a("siteMonthCannotLtOne")),i=!1;break}}i&&o()}}]});oe().then(({data:n})=>{const e={};n.forEach(o=>{e[o.group_id]=o}),v.value=e});const D=(n=0)=>{n||(m.value=!1,_.value=!0)},M=n=>{let e=[];n.forEach(o=>{e.push({group_id:o,num:1,month:1})}),t.value.create_site_limit=e},S=async n=>{m.value||!n||await n.validate(async e=>{e&&(m.value=!0,te(t.value).then(()=>{m.value=!1,_.value=!1,N("complete")}).catch(()=>{m.value=!1}))})},V=d(!0),y=d(!0),C=d(!0);return B({showDialog:_,setFormData:D}),(n,e)=>{const o=H,i=K,g=X,f=Y,k=J,$=Q,q=W,F=Z,U=ee,G=le,R=ae;return b(),h(G,{modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=l=>_.value=l),title:u(a)("addUser"),width:"750px","destroy-on-close":!0},{footer:r(()=>[c("span",ue,[s(U,{onClick:e[10]||(e[10]=l=>_.value=!1)},{default:r(()=>[w(p(u(a)("cancel")),1)]),_:1}),s(U,{type:"primary",loading:m.value,onClick:e[11]||(e[11]=l=>S(P.value))},{default:r(()=>[w(p(u(a)("confirm")),1)]),_:1},8,["loading"])])]),default:r(()=>[s(F,null,{default:r(()=>[c("div",re,[O((b(),h(q,{model:t.value,"label-width":"120px",ref_key:"formRef",ref:P,rules:L.value,class:"page-form",autocomplete:"off"},{default:r(()=>[s(i,{label:u(a)("username"),prop:"username"},{default:r(()=>[s(o,{modelValue:t.value.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.username=l),clearable:"",placeholder:u(a)("usernamePlaceholder"),class:"input-width",readonly:V.value,onClick:e[1]||(e[1]=l=>V.value=!1),onBlur:e[2]||(e[2]=l=>V.value=!0)},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),s(i,{label:u(a)("password"),prop:"password"},{default:r(()=>[s(o,{modelValue:t.value.password,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.password=l),clearable:"",placeholder:u(a)("passwordPlaceholder"),class:"input-width","show-password":!0,type:"password",readonly:y.value,onClick:e[4]||(e[4]=l=>y.value=!1),onBlur:e[5]||(e[5]=l=>y.value=!0)},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),s(i,{label:u(a)("confirmPassword"),prop:"confirm_password"},{default:r(()=>[s(o,{modelValue:t.value.confirm_password,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.confirm_password=l),placeholder:u(a)("confirmPasswordPlaceholder"),type:"password","show-password":!0,clearable:"",class:"input-width",readonly:C.value,onClick:e[7]||(e[7]=l=>C.value=!1),onBlur:e[8]||(e[8]=l=>C.value=!0)},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),Object.keys(v.value).length?(b(),h(i,{key:0,label:u(a)("userCreateSiteLimit"),prop:"create_site_limit"},{default:r(()=>[c("div",null,[c("div",null,p(u(a)("siteGroup")),1),s(f,{modelValue:t.value.group_ids,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.group_ids=l),onChange:M},{default:r(()=>[(b(!0),I(j,null,z(v.value,l=>(b(),h(g,{label:l.group_id},{default:r(()=>[w(p(l.group_name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),c("div",se,[c("div",null,p(u(a)("userCreateSiteLimit")),1),s($,{data:t.value.create_site_limit,size:"large",class:"w-full"},{default:r(()=>[s(k,{label:u(a)("siteGroup"),"show-overflow-tooltip":!0},{default:r(({row:l})=>[w(p(v.value[l.group_id]?v.value[l.group_id].group_name:""),1)]),_:1},8,["label"]),s(k,{label:u(a)("siteNum")},{default:r(({$index:l})=>[s(o,{modelValue:t.value.create_site_limit[l].num,"onUpdate:modelValue":E=>t.value.create_site_limit[l].num=E,modelModifiers:{number:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),s(k,{label:u(a)("siteMonth")},{default:r(({$index:l})=>[s(o,{modelValue:t.value.create_site_limit[l].month,"onUpdate:modelValue":E=>t.value.create_site_limit[l].month=E,modelModifiers:{number:!0}},{append:r(()=>[w(p(u(a)("month")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data"])])]),_:1},8,["label"])):A("",!0)]),_:1},8,["model","rules"])),[[R,m.value]])])]),_:1})]),_:1},8,["modelValue","title"])}}});export{Pe as _};

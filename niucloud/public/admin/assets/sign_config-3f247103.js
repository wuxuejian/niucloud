import{d as re,x as de,r as f,n as E,q as a,h as r,c as _,R as j,s as y,w as l,e as d,a as u,t as o,u as n,B as w,F as q,T as z,i as S,aR as ue,L as ce,aD as pe,ab as _e,E as fe,ac as me,K as ve,a6 as ge,M as ye,X as we,Y as Se,p as be,g as xe}from"./index-39857e33.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css               *//* empty css                        *//* empty css                  */import{h as he,i as G,s as ke}from"./member-3324c9c4.js";import Ce from"./sign-day-70aa6750.js";import Oe from"./sign-continue-f5786290.js";import{_ as Ve}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                 */const K=N=>(be("data-v-5de3fa6d"),N=N(),xe(),N),Ee={class:"main-container"},Ne={class:"panel-title !text-sm"},De=K(()=>u("span",{class:"ml-[10px]"},"天",-1)),Je={key:0},Ae={key:1,class:"flex ml-[5px]"},Te=K(()=>u("span",{class:"ml-[5px] mr-[5px]"},"|",-1)),Re={class:"form-tip"},$e={class:"form-tip"},Be={class:"mt-[10px]"},Fe={key:0},Ie={key:0},Ue={key:1},Le={class:"flex mt-[10px]"},Pe={class:"form-tip"},Me={class:"flex"},je={class:"dialog-footer"},qe={class:"dialog-footer"},ze={class:"fixed-footer-wrap"},Ge={class:"fixed-footer"},Ke=re({__name:"sign_config",setup(N){de().meta.title,f("signSet");const O=f(!0),V=f(!1),h=f(!1),$=f(),c=f({});let D=!1,J=0;const X=E({sign_period:[{required:!0,message:a("signPeriodTip"),trigger:"blur"}]}),m=E({gifts:[]}),T=f([]),t=E({is_use:0,sign_period:30,day_award:"",continue_award:[],rule_explain:""}),b=E({receive_num:"",continue_sign:"",receive_limit:"",continue_award:[]}),v=E({loading:!1,data:[]});(async()=>{const s=await(await he()).data;Object.keys(t).forEach(e=>{s[e]!=null&&(t[e]=s[e])}),t.day_award&&(m.gifts=t.day_award,B()),t.continue_award&&t.continue_award.forEach((e,x)=>{v.data.push(JSON.parse(JSON.stringify(e))),m.gifts=[];const p=JSON.parse(JSON.stringify(e));delete p.continue_sign,delete p.continue_tag,delete p.receive_limit,delete p.receive_num,m.gifts=p,F(m,e,x)}),O.value=!1})();const A=f([]),B=async()=>{const s=await(await G(m)).data;A.value=[],Object.values(s).forEach(e=>{A.value.push(e)})},F=async(s,e,x=0,p=0)=>{const R=await(await G(s)).data;T.value=[],Object.values(R).forEach(k=>{T.value.push(k)}),b.receive_num=e.receive_num,b.continue_sign=e.continue_sign,b.receive_limit=e.receive_limit,b.continue_award=T.value,D?v.data.splice(J,1,JSON.parse(JSON.stringify(b))):p==0?v.data.splice(x,1,JSON.parse(JSON.stringify(b))):v.data.push(JSON.parse(JSON.stringify(b))),D=!1,J=0},Y=async s=>{O.value||!s||await s.validate(e=>{if(e){const x=JSON.parse(JSON.stringify(t));ke(x).then(()=>{O.value=!1}).catch(()=>{O.value=!1})}})},I=()=>{V.value=!0},U=f(null),H=async()=>{var s;await((s=U.value)==null?void 0:s.verify())&&(V.value=!1,!t.day_award.hasOwnProperty("balance")&&!t.day_award.hasOwnProperty("point")&&t.day_award.shop_coupon.is_use==0&&(t.day_award=""),m.gifts=t.day_award,B())},Q=()=>{t.day_award="",A.value=[]},W=()=>{c.value="",h.value=!0},Z=(s,e)=>{D=s,J=e,c.value=t.continue_award[e],h.value=!0},L=f(null),ee=async()=>{var s;if(await((s=L.value)==null?void 0:s.verify())&&(h.value=!1,!c.value.hasOwnProperty("balance")&&!c.value.hasOwnProperty("point")&&c.value.shop_coupon.is_use==0&&(c.value=""),Object.keys(c.value).length>0)){const e=JSON.parse(JSON.stringify(c.value));delete e.continue_sign,delete e.continue_tag,delete e.receive_limit,delete e.receive_num,m.gifts=e,t.continue_award.length>0&&t.continue_award.length-1,F(m,c.value,0,1),D?t.continue_award.splice(J,1,JSON.parse(JSON.stringify(c.value))):t.continue_award.push(JSON.parse(JSON.stringify(c.value)))}},te=s=>{v.data.splice(s,1),t.continue_award.splice(s,1)},ae=()=>{t.rule_explain=a("ruleExplainDefault")};return(s,e)=>{const x=ue,p=ce,R=pe,k=_e,g=fe,ne=me,ie=ve,le=ge,oe=ye,P=we,M=Se;return r(),_("div",Ee,[j((r(),y(oe,{class:"page-form",model:t,"label-width":"150px",ref_key:"ruleFormRef",ref:$,rules:X},{default:l(()=>[d(le,{class:"box-card !border-none",shadow:"never"},{default:l(()=>[u("h3",Ne,o(n(a)("signRule")),1),d(p,{label:n(a)("isUse")},{default:l(()=>[d(x,{modelValue:t.is_use,"onUpdate:modelValue":e[0]||(e[0]=i=>t.is_use=i)},null,8,["modelValue"])]),_:1},8,["label"]),t.is_use?(r(),y(p,{key:0,label:n(a)("signPeriod")},{default:l(()=>[d(R,{modelValue:t.sign_period,"onUpdate:modelValue":e[1]||(e[1]=i=>t.sign_period=i),clearable:"",class:"input-width","controls-position":"right"},null,8,["modelValue"]),De]),_:1},8,["label"])):w("",!0),t.is_use?(r(),y(p,{key:1,label:n(a)("daySignAward"),prop:"formData.day_award"},{default:l(()=>[(r(!0),_(q,null,z(A.value,(i,C)=>(r(),_("div",{key:C},[i.is_use=="1"?(r(),_("span",Je,o(i.content)+"  ",1)):w("",!0)]))),128)),t.day_award==""?(r(),_("span",{key:0,class:"cursor-pointer tutorial-btn ml-[5px]",onClick:I},o(n(a)("set")),1)):(r(),_("div",Ae,[u("span",{class:"cursor-pointer tutorial-btn",onClick:I},o(n(a)("modify")),1),Te,u("span",{class:"cursor-pointer tutorial-btn",onClick:Q},o(n(a)("delete")),1)])),u("div",Re,o(n(a)("daySignAwardTip")),1)]),_:1},8,["label"])):w("",!0),t.is_use?(r(),y(p,{key:2,label:n(a)("continueSignAward"),prop:"formData.continue_award"},{default:l(()=>[u("div",null,[u("div",$e,o(n(a)("continueSignAwardTipTop")),1),u("div",Be,[j((r(),y(ne,{data:v.data,size:"large"},{empty:l(()=>[u("span",null,o(v.loading?"":n(a)("emptyData")),1)]),default:l(()=>[d(k,{prop:"continue_sign",label:n(a)("continueSign"),"min-width":"120"},null,8,["label"]),d(k,{label:n(a)("continueSignAward"),"min-width":"300"},{default:l(({row:i})=>[(r(!0),_(q,null,z(i.continue_award,(C,se)=>(r(),_("div",{key:se},[C.is_use=="1"?(r(),_("span",Fe,o(C.content),1)):w("",!0)]))),128))]),_:1},8,["label"]),d(k,{label:n(a)("receiveLimit"),"min-width":"120"},{default:l(({row:i})=>[i.receive_limit==1?(r(),_("span",Ie,o(n(a)("noLimit")),1)):(r(),_("span",Ue,o(n(a)("everyOneLimit"))+o(i.receive_num)+o(n(a)("time")),1))]),_:1},8,["label"]),d(k,{label:n(a)("operation"),align:"right",fixed:"right",width:"130"},{default:l(i=>[d(g,{type:"primary",link:"",onClick:C=>Z(!0,i.$index)},{default:l(()=>[S(o(n(a)("modify")),1)]),_:2},1032,["onClick"]),d(g,{type:"primary",link:"",onClick:C=>te(i.$index)},{default:l(()=>[S(o(n(a)("delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[M,v.loading]])]),u("div",Le,[u("span",{class:"cursor-pointer tutorial-btn",onClick:W},o(n(a)("add")),1)]),u("div",Pe,o(n(a)("continueSignAwardTipBottom")),1)])]),_:1},8,["label"])):w("",!0),t.is_use?(r(),y(p,{key:3,label:n(a)("ruleExplain"),prop:"formData.rule_explain"},{default:l(()=>[u("div",Me,[d(ie,{modelValue:t.rule_explain,"onUpdate:modelValue":e[2]||(e[2]=i=>t.rule_explain=i),placeholder:n(a)("ruleExplainTip"),type:"textarea",rows:"5",class:"textarea-width",clearable:""},null,8,["modelValue","placeholder"]),d(g,{class:"ml-[20px]",type:"primary",onClick:e[3]||(e[3]=i=>ae()),plain:""},{default:l(()=>[S(o(n(a)("useDefaultExplain")),1)]),_:1})])]),_:1},8,["label"])):w("",!0)]),_:1})]),_:1},8,["model","rules"])),[[M,O.value]]),t.is_use?(r(),y(P,{key:0,modelValue:V.value,"onUpdate:modelValue":e[7]||(e[7]=i=>V.value=i),title:n(a)("daySignTitle"),width:"1200px","destroy-on-close":!0},{footer:l(()=>[u("span",je,[d(g,{onClick:e[5]||(e[5]=i=>V.value=!1)},{default:l(()=>[S(o(n(a)("cancel")),1)]),_:1}),d(g,{type:"primary",onClick:e[6]||(e[6]=i=>H())},{default:l(()=>[S(o(n(a)("confirm")),1)]),_:1})])]),default:l(()=>[d(Ce,{ref_key:"benefitsRef",ref:U,modelValue:t.day_award,"onUpdate:modelValue":e[4]||(e[4]=i=>t.day_award=i)},null,8,["modelValue"])]),_:1},8,["modelValue","title"])):w("",!0),t.is_use?(r(),y(P,{key:1,modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]=i=>h.value=i),title:n(a)("continueSignTitle"),width:"1200px","destroy-on-close":!0},{footer:l(()=>[u("span",qe,[d(g,{onClick:e[9]||(e[9]=i=>h.value=!1)},{default:l(()=>[S(o(n(a)("cancel")),1)]),_:1}),d(g,{type:"primary",onClick:e[10]||(e[10]=i=>ee())},{default:l(()=>[S(o(n(a)("confirm")),1)]),_:1})])]),default:l(()=>[d(Oe,{ref_key:"continueRef",ref:L,modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=i=>c.value=i)},null,8,["modelValue"])]),_:1},8,["modelValue","title"])):w("",!0),u("div",ze,[u("div",Ge,[d(g,{type:"primary",onClick:e[12]||(e[12]=i=>Y($.value))},{default:l(()=>[S(o(n(a)("save")),1)]),_:1})])])])}}});const yt=Ve(Ke,[["__scopeId","data-v-5de3fa6d"]]);export{yt as default};

import{d as O,O as G,n as Z,r as f,f as q,h as m,c as g,e as a,w as o,a as u,t as i,u as l,i as p,N as t,F as C,G as D,I as v,y as J,R as K,E as Q,Z as W,_ as X,av as ee,aT as ae,da as le,$ as te,ac as re,ak as oe,aB as ne,am as ie,a3 as se,a4 as me}from"./index-022827e1.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                     *//* empty css                       *//* empty css                  */import{_ as de}from"./default_headimg-a897263d.js";import{B as pe,v as ce,p as ue,C as _e}from"./member-394fe4e5.js";import{_ as be}from"./add-member.vue_vue_type_script_setup_true_lang-55d30880.js";import{_ as ge}from"./edit-member.vue_vue_type_script_setup_true_lang-43d489c1.js";/* empty css                   */import"./index-edd24909.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-3b291a1c.js";import"./attachment-b3c743b5.js";/* empty css                 *//* empty css                 *//* empty css               *//* empty css                    *//* empty css                         *//* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-f0968e2c.js";/* empty css                */import"./_plugin-vue_export-helper-c27b6911.js";const fe={class:"main-container"},he={class:"flex justify-between items-center"},ve={class:"text-page-title"},ye={class:"mt-[10px]"},ke={class:"flex items-center"},we=["src"],xe={key:1,class:"w-[50px] h-[50px] mr-[10px]",src:de,alt:""},Ce={class:"flex flex flex-col"},De={class:"flex flex-col items-center"},Pe={class:"flex items-center"},Ve={class:"mt-[16px] flex justify-end"},ua=O({__name:"member",setup(Ee){const F=G().meta.title,n=Z({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{keyword:"",register_type:"",member_label:"",register_channel:"",create_time:[]}}),P=f(),V=f([]);(async()=>{V.value=await(await pe({})).data})();const E=f([]);(async()=>{E.value=await(await ce()).data})();const T=s=>{s&&(s.resetFields(),_())},_=(s=1)=>{n.loading=!0,n.page=s,ue({page:n.page,limit:n.limit,...n.searchParam}).then(r=>{n.loading=!1,n.data=r.data.data,n.total=r.data.total}).catch(()=>{n.loading=!1})};_();const B=q(),k=f(null),w=f(null);function I(s){const r=f({type:"member_label",id:s.member_id,title:t("setLable"),data:s});w.value.setDialogType(r.value),w.value.showDialog=!0}const N=()=>{k.value.setFormData(),k.value.showDialog=!0},z=s=>{B.push(`/member/detail?id=${s.member_id}`)},L=(s,r)=>{_e({status:r,member_ids:[s.member_id]}).then(b=>{b.code>=0&&_()})};return(s,r)=>{const b=Q,R=W,h=X,y=ee,M=ae,U=le,S=te,$=re,d=oe,x=ne,Y=ie,j=se,A=me;return m(),g("div",fe,[a($,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[u("div",he,[u("span",ve,i(l(F)),1),a(b,{type:"primary",onClick:N},{default:o(()=>[p(i(l(t)("addMember")),1)]),_:1})]),a($,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:o(()=>[a(S,{inline:!0,model:n.searchParam,ref_key:"searchFormRef",ref:P},{default:o(()=>[a(h,{label:l(t)("memberInfo"),prop:"keyword"},{default:o(()=>[a(R,{modelValue:n.searchParam.keyword,"onUpdate:modelValue":r[0]||(r[0]=e=>n.searchParam.keyword=e),class:"w-[240px]",placeholder:l(t)("memberInfoPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(h,{label:l(t)("registerChannel"),prop:"register_channel"},{default:o(()=>[a(M,{modelValue:n.searchParam.register_channel,"onUpdate:modelValue":r[1]||(r[1]=e=>n.searchParam.register_channel=e),clearable:"",placeholder:l(t)("channelPlaceholder"),class:"input-width"},{default:o(()=>[a(y,{label:l(t)("selectPlaceholder"),value:""},null,8,["label"]),(m(!0),g(C,null,D(V.value,(e,c)=>(m(),v(y,{label:e,value:c,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(h,{label:l(t)("memberLabel"),prop:"member_label"},{default:o(()=>[a(M,{modelValue:n.searchParam.member_label,"onUpdate:modelValue":r[2]||(r[2]=e=>n.searchParam.member_label=e),"collapse-tags":"",clearable:"",placeholder:l(t)("memberLabelPlaceholder"),class:"input-width"},{default:o(()=>[a(y,{label:l(t)("selectPlaceholder"),value:""},null,8,["label"]),(m(!0),g(C,null,D(E.value,(e,c)=>(m(),v(y,{label:e.label_name,value:e.label_id,key:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(h,{label:l(t)("createTime"),prop:"create_time"},{default:o(()=>[a(U,{modelValue:n.searchParam.create_time,"onUpdate:modelValue":r[3]||(r[3]=e=>n.searchParam.create_time=e),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":l(t)("startDate"),"end-placeholder":l(t)("endDate")},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),a(h,null,{default:o(()=>[a(b,{type:"primary",onClick:r[4]||(r[4]=e=>_())},{default:o(()=>[p(i(l(t)("search")),1)]),_:1}),a(b,{onClick:r[5]||(r[5]=e=>T(P.value))},{default:o(()=>[p(i(l(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),u("div",ye,[J((m(),v(Y,{data:n.data,size:"large"},{empty:o(()=>[u("span",null,i(n.loading?"":l(t)("emptyData")),1)]),default:o(()=>[a(d,{prop:"member_no",label:l(t)("memberNo"),"min-width":"120"},null,8,["label"]),a(d,{prop:"nickname","show-overflow-tooltip":!0,label:l(t)("memberInfo"),"min-width":"170"},{default:o(({row:e})=>[u("div",ke,[e.headimg?(m(),g("img",{key:0,class:"w-[50px] h-[50px] mr-[10px]",src:l(K)(e.headimg),alt:""},null,8,we)):(m(),g("img",xe)),u("div",Ce,[u("span",null,i(e.nickname||""),1)])])]),_:1},8,["label"]),a(d,{prop:"mobile",label:l(t)("mobile"),"min-width":"120"},null,8,["label"]),a(d,{prop:"point",label:l(t)("point"),"min-width":"80",align:"right"},{default:o(({row:e})=>[p(i(Number.parseInt(e.point)),1)]),_:1},8,["label"]),a(d,{prop:"balance",label:l(t)("balance"),"min-width":"130",align:"right"},null,8,["label"]),a(d,{prop:"member_label",label:l(t)("lable"),"min-width":"120",align:"center"},{default:o(({row:e})=>[u("div",De,[(m(!0),g(C,null,D(e.member_label_array,(c,H)=>(m(),g("div",{class:"my-[3px]",key:H},[a(x,{type:"info"},{default:o(()=>[p(i(c.label_name),1)]),_:2},1024)]))),128))])]),_:1},8,["label"]),a(d,{prop:"register_channel_name",label:l(t)("registerChannel"),"min-width":"110",align:"center"},null,8,["label"]),a(d,{prop:"member_label",label:l(t)("status"),"min-width":"120",align:"center"},{default:o(({row:e})=>[e.status==1?(m(),v(x,{key:0,type:"success",onClick:c=>L(e,0),class:"cursor-pointer"},{default:o(()=>[p(i(l(t)("normal")),1)]),_:2},1032,["onClick"])):(m(),v(x,{key:1,type:"error",onClick:c=>L(e,1),class:"cursor-pointer"},{default:o(()=>[p(i(l(t)("lock")),1)]),_:2},1032,["onClick"]))]),_:1},8,["label"]),a(d,{label:l(t)("createTime"),"min-width":"150",align:"center"},{default:o(({row:e})=>[p(i(e.create_time||""),1)]),_:1},8,["label"]),a(d,{label:l(t)("lastVisitTime"),"min-width":"150",align:"center"},{default:o(({row:e})=>[p(i(e.last_visit_time||""),1)]),_:1},8,["label"]),a(d,{label:l(t)("operation"),align:"right",fixed:"right",width:"100"},{default:o(({row:e})=>[u("div",Pe,[a(b,{type:"primary",link:"",onClick:c=>z(e)},{default:o(()=>[p(i(l(t)("detail")),1)]),_:2},1032,["onClick"]),a(b,{type:"primary",link:"",onClick:c=>I(e)},{default:o(()=>[p(i(l(t)("setLable")),1)]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"])),[[A,n.loading]]),u("div",Ve,[a(j,{"current-page":n.page,"onUpdate:current-page":r[6]||(r[6]=e=>n.page=e),"page-size":n.limit,"onUpdate:page-size":r[7]||(r[7]=e=>n.limit=e),layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:r[8]||(r[8]=e=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])]),a(be,{ref_key:"addMemberDialog",ref:k,onComplete:r[9]||(r[9]=e=>_())},null,512),a(ge,{ref_key:"editMemberDialog",ref:w,onComplete:r[10]||(r[10]=e=>_())},null,512)]),_:1})])}}});export{ua as default};

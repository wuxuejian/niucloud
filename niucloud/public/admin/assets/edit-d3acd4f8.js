import{d as ve,bD as xe,x as ge,f as he,r as h,n as J,Q as be,bu as we,a2 as ye,h as c,c as x,e as l,w as i,a,t as u,u as t,q as s,F as C,T as D,s as w,i as $,B as k,$ as Q,v as Ce,Z as M,aY as K,A as ke,a4 as ee,an as te,a1 as Ve,aa as ze,aB as Te,E as Ee,bE as Pe,bA as Me,bB as Ie,V as Se,aU as Be,L as qe,bz as De,bv as $e,as as Ue,at as Ne,M as je,a6 as Fe,X as Le,p as Re,g as Oe}from"./index-34979a7f.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                        *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                         */import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang-e10327f5.js";/* empty css               *//* empty css                  *//* empty css                  */import{_ as Ze}from"./edit-draw-759a54d8.js";import{_ as Ge}from"./edit-headimg-aea95fe1.js";import{_ as He}from"./edit-image-08682812.js";import{_ as We}from"./edit-nickname-b0787a2d.js";import{_ as Xe}from"./edit-page-33b65a9a.js";import{_ as Ye}from"./edit-qrcode-6237209e.js";import{_ as Je}from"./edit-text-e31b729d.js";import{_ as Qe}from"./preview-draw-a77d258f.js";import{_ as Ke}from"./preview-headimg-700b0dc9.js";import{_ as et}from"./preview-image-3c4dc303.js";import{_ as tt}from"./preview-nickname-b93d9613.js";import{_ as ot}from"./preview-qrcode-fc99b918.js";import{_ as nt}from"./preview-text-0408433a.js";import{u as lt}from"./poster-26efbf86.js";import{i as at,g as st,e as it,a as rt,b as pt}from"./poster-68ae9695.js";import{_ as ct}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-0da618fa.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-645eb1b7.js";import"./attachment-0daaf0f6.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-d47218dc.js";/* empty css                      *//* empty css                    *//* empty css                 *//* empty css               *//* empty css                    *//* empty css                    */import"./el-dropdown-item-4ed993c7.js";import"./index.vue_vue_type_script_setup_true_lang-0998f18f.js";/* empty css                   */import"./sortable.esm-be94e56d.js";/* empty css                  */import"./default_headimg-a897263d.js";const O=I=>(Re("data-v-a30efbac"),I=I(),Oe(),I),dt={class:"main-container flex-1"},ut={class:"pl-[5px] text-[14px]"},mt={class:"text-white ml-[10px] mr-[20px] flex items-center"},_t=O(()=>a("span",{class:"mr-[5px] text-[rgba(255,255,255,.5)]"},"｜",-1)),ft={class:"mr-[5px] text-[14px]"},vt={class:"text-white mr-[10px] text-base"},xt=O(()=>a("div",{class:"flex-1"},null,-1)),gt={class:"full-container flex flex-row flex-1 bg-page"},ht={class:"component-list w-[290px]"},bt={class:"flex flex-row flex-wrap"},wt=["title","onClick"],yt={class:"block text-[12px] truncate"},Ct={class:"preview-wrap flex-1 relative mt-[20px]"},kt={class:"diy-view-wrap w-[360px] shadow-lg mx-auto"},Vt={class:"content-wrap"},zt={class:"title-wrap text-center text-[14px]"},Tt={class:"preview-block relative"},Et={class:"quick-action absolute text-center -right-[70px] top-[20px] w-[42px] rounded shadow-md"},Pt=["id","onMousedown","onClick"],Mt=["onMousedown"],It=["onMousedown"],St=["onMousedown"],Bt=["onMousedown"],qt={class:"edit-attribute-wrap w-[400px]"},Dt={class:"card-header flex justify-between items-center"},$t={class:"title flex-1"},Ut={class:"edit-component-wrap"},Nt={class:"edit-attr-item-wrap"},jt={class:"mb-[10px]"},Ft=O(()=>a("div",{class:"my-[10px]"},null,-1)),Lt={class:"ml-[92px] mb-[18px] text-sm text-gray-400"},Rt={key:0},Ot=["src"],At=ve({__name:"edit",setup(I){xe("setLayout")("decorate");const e=lt(),_=ge(),oe=he();_.query.id=_.query.id||0,_.query.type=_.query.type||"",_.query.name=_.query.name||"",_.query.back=_.query.back||"/site/poster/list";const S=_.query.back,B=h(""),A=h(""),V=h([]),Z=J([]);h("");const G=h(Z),ne=p=>{},le=h(!0),ae=()=>{le.value?(location.href=`${location.origin}${S}`,oe.push(S)):ee.confirm(s("leavePageTitleTips"),s("leavePageContentTips"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning",autofocus:!1}).then(()=>{location.href=`${location.origin}${S}`}).catch(()=>{})},H=Object.assign({"./components/edit-draw.vue":Ze,"./components/edit-headimg.vue":Ge,"./components/edit-image.vue":He,"./components/edit-nickname.vue":We,"./components/edit-page.vue":Xe,"./components/edit-qrcode.vue":Ye,"./components/edit-text.vue":Je,"./components/preview-draw.vue":Qe,"./components/preview-headimg.vue":Ke,"./components/preview-image.vue":et,"./components/preview-nickname.vue":tt,"./components/preview-qrcode.vue":ot,"./components/preview-text.vue":nt}),W=Object.assign({});W&&Object.assign(H,W);const U={};for(const[p,o]of Object.entries(H)){const r=p.split("/").pop().split(".")[0];U[r]=o.default}const z=J([]),se=()=>{st({addon:e.addon,type:e.type}).then(p=>{p.data&&z.splice(0,z.length,...p.data)})};be(()=>B.value,(p,o)=>{A.value=o});const ie=p=>{if(e.value.length)ee.confirm(s("changeTemplatePosterTips"),s("warning"),{confirmButtonText:s("confirm"),cancelButtonText:s("cancel"),type:"warning"}).then(()=>{if(e.changeCurrentIndex(-99),p!==""){let o=z[p].data;e.global=o.global,o.value.length&&(e.value=o.value)}else e.init()}).catch(()=>{B.value=A.value});else if(p!==""){let o=z[p].data;e.global=o.global,o.value.length&&(e.value=o.value)}else e.init()};at({id:_.query.id,type:_.query.type,name:_.query.name}).then(async p=>{const o=p.data;if(e.init(),e.id=o.id,e.name=o.name,e.channel=o.channel,e.status=o.status,e.isDefault=o.is_default,e.addon=o.addon,e.type=o.type,e.typeName=o.poster_type.name,o.value){const f=o.value;e.global=f.global,f.value.length&&(e.value=f.value)}V.value=o.component;for(const f in V.value){Z.push(f);for(const r in V.value[f].list){const v=we(V.value[f].list[r]);v.id=e.generateRandom(),v.componentName=r,v.componentTitle=v.title,delete v.title,delete v.icon,e.components.push(v)}}se()});const b=h(!1),re=p=>{if(!e.verify()||b.value)return;b.value=!0,e.value.forEach((r,v)=>{const T=document.getElementById(r.id);if(T&&(r.width=T.offsetWidth,r.height=T.offsetHeight,r.type=="draw")){let E=[r.x*2,r.y*2],F=[(r.x+r.width)*2,r.y*2],g=[(r.x+r.width)*2,(r.y+r.height)*2],L=[r.x*2,(r.y+r.height)*2];r.points=[E,F,g,L]}delete r.verify});let o={id:e.id,name:e.name,type:e.type,status:e.status,is_default:e.isDefault,channel:e.channel,addon:e.addon,value:JSON.stringify({global:te(e.global),value:te(e.value)})};(e.id?it:rt)(o).then(r=>{b.value=!1,r.code==1&&(e.id?b.value=!1:location.href=`${location.origin}${S}`,p&&p(r.data.id))}).catch(()=>{b.value=!1})},N=h(!1),j=h(""),pe=()=>{b.value||(b.value=!0,pt({id:e.id,type:e.type}).then(p=>{p.data&&(j.value=p.data,N.value=!0),b.value=!1}))};return(p,o)=>{const f=ye("ArrowLeft"),r=Ve,v=ze,T=Te,E=Ee,F=Pe,g=Ae,L=Me,ce=Ie,R=Se,P=Be,y=qe,q=De,X=$e,de=Ue,ue=Ne,me=je,_e=Fe,fe=Le;return c(),x("div",dt,[l(F,{class:"flex items-center h-[60px] bg-primary px-[20px]"},{default:i(()=>[a("div",{class:"text-white cursor-pointer flex items-center",onClick:ae},[l(r,{size:"14"},{default:i(()=>[l(f)]),_:1}),a("span",ut,u(t(s)("back")),1)]),a("div",mt,[_t,a("span",ft,u(t(s)("decorating"))+"："+u(t(e).typeName),1)]),a("div",null,[a("span",vt,u(t(s)("templatePosterPlaceholder")),1),l(T,{size:"small",modelValue:B.value,"onUpdate:modelValue":o[0]||(o[0]=n=>B.value=n),class:"w-[180px]",placeholder:t(s)("templatePosterPlaceholder"),onChange:ie},{default:i(()=>[l(v,{label:t(s)("templatePosterEmpty"),value:""},null,8,["label"]),(c(!0),x(C,null,D(z,(n,m)=>(c(),w(v,{label:n.name,value:m,key:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),xt,t(e).id?(c(),w(E,{key:0,onClick:o[1]||(o[1]=n=>pe())},{default:i(()=>[$(u(t(s)("preview")),1)]),_:1})):k("",!0),l(E,{onClick:o[2]||(o[2]=n=>re())},{default:i(()=>[$(u(t(s)("save")),1)]),_:1})]),_:1}),a("div",gt,[a("div",ht,[l(R,{class:"px-[10px]"},{default:i(()=>[l(ce,{modelValue:G.value,"onUpdate:modelValue":o[3]||(o[3]=n=>G.value=n),onChange:ne},{default:i(()=>[(c(!0),x(C,null,D(V.value,(n,m)=>(c(),w(L,{key:m,title:n.title,name:m},{default:i(()=>[a("ul",bt,[(c(!0),x(C,null,D(n.list,(d,Y)=>(c(),x("li",{key:Y,class:"w-2/6 text-center cursor-pointer h-[65px]",title:d.title,onClick:Gt=>t(e).addComponent(Y,d)},[d.icon?(c(),w(g,{key:0,name:d.icon,size:"20px",class:"inline-block mt-[3px]"},null,8,["name"])):(c(),w(g,{key:1,name:"iconfont iconkaifazujian",size:"20px",class:"inline-block mt-[3px]"})),a("span",yt,u(d.title),1)],8,wt))),128))])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a("div",Ct,[l(R,null,{default:i(()=>[l(E,{class:"page-btn absolute right-[20px]",onClick:o[4]||(o[4]=n=>t(e).changeCurrentIndex(-99))},{default:i(()=>[$(u(t(s)("posterSet")),1)]),_:1}),a("div",kt,[a("div",{class:"preview-head bg-no-repeat bg-center bg-cover cursor-pointer h-[64px]",onClick:o[5]||(o[5]=n=>t(e).changeCurrentIndex(-99))},[a("div",Vt,[a("div",zt,u(t(e).name),1)])]),a("div",Tt,[a("ul",Et,[l(P,{effect:"light",content:t(s)("moveUpComponentZIndex"),placement:"right"},{default:i(()=>[l(g,{name:"iconfont iconjiantoushang",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).moveUpComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("moveDownComponentZIndex"),placement:"right"},{default:i(()=>[l(g,{name:"iconfont iconjiantouxia",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).moveDownComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("copyComponent"),placement:"right"},{default:i(()=>[l(g,{name:"iconfont iconcopy-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).copyComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("delComponent"),placement:"right"},{default:i(()=>[l(g,{name:"iconfont icondelete-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).delComponent},null,8,["onClick"])]),_:1},8,["content"]),l(P,{effect:"light",content:t(s)("resetComponent"),placement:"right"},{default:i(()=>[l(g,{name:"iconfont iconloader-line",size:"20px",class:"block cursor-pointer leading-[40px]",onClick:t(e).resetComponent},null,8,["onClick"])]),_:1},8,["content"])]),a("div",{class:"preview-iframe",style:Q(t(e).getGlobalStyle()),onClick:o[6]||(o[6]=n=>t(e).changeCurrentIndex(-99))},[(c(!0),x(C,null,D(t(e).value,(n,m)=>(c(),x("div",{class:Ce(["item-wrap area-box select-none max-w-[360px] cursor-move",{selected:t(e).currentIndex==m}]),id:n.id,key:n.id,style:Q({top:n.y+"px",left:n.x+"px",zIndex:n.zIndex,transform:"rotate("+n.angle+"deg)"}),onMousedown:d=>t(e).mouseDown(d,n.id,m),onClick:M(d=>t(e).changeCurrentIndex(m,n),["stop"])},[(c(),w(K(U["preview-"+n.path]),{value:n},null,8,["value"])),a("span",{class:"box1",onMousedown:M(d=>t(e).resizeMouseDown(d,n,m),["stop"])},null,40,Mt),a("span",{class:"box2",onMousedown:M(d=>t(e).resizeMouseDown(d,n,m),["stop"])},null,40,It),a("span",{class:"box3",onMousedown:M(d=>t(e).resizeMouseDown(d,n,m),["stop"])},null,40,St),a("span",{class:"box4",onMousedown:M(d=>t(e).resizeMouseDown(d,n,m),["stop"])},null,40,Bt)],46,Pt))),128))],4)])])]),_:1})]),a("div",qt,[l(R,null,{default:i(()=>[l(_e,{class:"box-card",shadow:"never"},{header:i(()=>[a("div",Dt,[a("span",$t,u(t(e).currentIndex==-99?t(s)("posterSet"):t(e).editComponent.componentTitle),1)])]),default:i(()=>[a("div",Ut,[t(e).currentComponent?(c(),w(K(U[t(e).currentComponent]),{key:0,value:t(e).value[t(e).currentIndex]},{common:i(()=>[a("div",Nt,[a("h3",jt,u(t(s)("componentStyleTitle")),1),l(me,{"label-width":"80px",class:"px-[10px]"},{default:i(()=>[l(y,{label:t(s)("zIndex")},{default:i(()=>[a("span",null,u(t(e).editComponent.zIndex),1)]),_:1},8,["label"]),l(y,{label:t(s)("coordinate")},{default:i(()=>[l(q,{modelValue:t(e).editComponent.x,"onUpdate:modelValue":o[7]||(o[7]=n=>t(e).editComponent.x=n),"show-input":"",size:"small",class:"ml-[10px]",min:0,max:t(e).getMaxX()},null,8,["modelValue","max"]),Ft,l(q,{modelValue:t(e).editComponent.y,"onUpdate:modelValue":o[8]||(o[8]=n=>t(e).editComponent.y=n),"show-input":"",size:"small",class:"ml-[10px]",min:0,max:t(e).getMaxY()},null,8,["modelValue","max"])]),_:1},8,["label"]),a("div",Lt,u(t(s)("coordinateTips")),1),t(e).editComponent.type=="text"?(c(),x(C,{key:0},[l(y,{label:t(s)("textFontSize")},{default:i(()=>[l(q,{modelValue:t(e).editComponent.fontSize,"onUpdate:modelValue":o[9]||(o[9]=n=>t(e).editComponent.fontSize=n),"show-input":"",size:"small",class:"ml-[10px]",min:14,max:36},null,8,["modelValue"])]),_:1},8,["label"]),l(y,{label:t(s)("textColor")},{default:i(()=>[l(X,{modelValue:t(e).editComponent.fontColor,"onUpdate:modelValue":o[10]||(o[10]=n=>t(e).editComponent.fontColor=n)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),t(e).editComponent.type=="image"?(c(),w(y,{key:1,label:t(s)("width")},{default:i(()=>[l(q,{modelValue:t(e).editComponent.width,"onUpdate:modelValue":o[11]||(o[11]=n=>t(e).editComponent.width=n),"show-input":"",size:"small",class:"ml-[10px]",min:30,max:t(e).getMaxWidth()},null,8,["modelValue","max"])]),_:1},8,["label"])):k("",!0),t(e).editComponent.type=="draw"?(c(),x(C,{key:2},[l(y,{label:t(s)("drawType")},{default:i(()=>[l(ue,{modelValue:t(e).editComponent.drawType,"onUpdate:modelValue":o[12]||(o[12]=n=>t(e).editComponent.drawType=n)},{default:i(()=>[l(de,{label:"Polygon"},{default:i(()=>[$(u(t(s)("polygon")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(y,{label:t(s)("bgColor")},{default:i(()=>[l(X,{modelValue:t(e).editComponent.bgColor,"onUpdate:modelValue":o[13]||(o[13]=n=>t(e).editComponent.bgColor=n)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0)]),_:1})])]),_:1},8,["value"])):k("",!0)])]),_:1})]),_:1})])]),l(fe,{modelValue:N.value,"onUpdate:modelValue":o[14]||(o[14]=n=>N.value=n),title:t(s)("previewDialogTitle"),width:"400px",height:"640px"},{default:i(()=>[j.value?(c(),x("div",Rt,[a("img",{src:t(ke)(j.value),class:"w-[360px] h-[640px]"},null,8,Ot)])):k("",!0)]),_:1},8,["modelValue","title"])])}}});const Wo=ct(At,[["__scopeId","data-v-a30efbac"]]);export{Wo as default};

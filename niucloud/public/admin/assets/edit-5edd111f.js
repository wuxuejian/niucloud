import{d as K,x as M,f as O,r as v,q as e,aQ as Q,P as Z,h as c,c as _,a as s,u as t,t as i,e as r,w as n,s as x,i as w,B as g,F as A,Q as L,dV as G,_ as J,R as H,J as W,K as X,E as Y,ak as ee,aI as le,L as te,a0 as ae,U as oe}from"./index-ae2d9b78.js";/* empty css                   *//* empty css                *//* empty css                *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  */import re from"./index-b111e282.js";import"./el-form-item-4ed993c7.js";import{a as se,b as ne,c as de,e as ue,f as pe,h as ie}from"./tools-5f7ff811.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-b2ddc674.js";/* empty css                  *//* empty css                   */import"./attachment-8d650cb6.js";import"./index.vue_vue_type_script_setup_true_lang-57aca5c9.js";/* empty css                      *//* empty css                    *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css               *//* empty css                    *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-43b3de63.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-657c47c5.js";/* empty css                */import"./_plugin-vue_export-helper-c27b6911.js";const ce={class:"main-container mb-80"},me={class:"detail-head !mb-[10px]"},ve=s("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),he={class:"ml-[1px]"},_e=s("span",{class:"adorn"},"|",-1),ge={class:"right"},ye={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},fe={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},xe={class:"text-[12px] text-[#a9a9a9] leading-normal"},be={key:1,class:"text-[12px] text-[#a9a9a9] leading-normal"},ke={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},Ve={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},Pe={class:"text-[12px] text-[#a9a9a9] leading-normal mt-[5px]"},we={class:"text-[12px] text-[#a9a9a9] leading-normal"},Ae={key:0,class:"fixed-footer-wrap"},Ee={class:"fixed-footer"},ul=K({__name:"edit",setup(qe){const h=M(),b=O(),D=h.meta.title,a=v({title:"",icon:"",key:"",desc:"",author:"",version:"",cover:"",type:"",support_app:"",support_type:1}),E=v([]),m=v(!1),q=v(),k=v([]),F=(u,l,d)=>l!==""?/^[a-zA-Z][a-zA-Z0-9_]*$/.test(l)?d():d(new Error(e("keyPlaceholderErr"))):d(new Error(e("keyPlaceholder"))),T=(u,l,d)=>l!==""?/^([0-9]\d|[0-9])(\.([0-9]){1}){2}$/.test(l)?d():d(new Error(e("versionPlaceholderErr"))):d(new Error(e("versionPlaceholder"))),N=v({title:[{required:!0,message:e("titlePlaceholder"),trigger:"blur"}],icon:[{required:!0,message:e("iconPlaceholder"),trigger:"change"}],key:[{required:!0,validator:F,trigger:"blur"}],author:[{required:!0,message:e("authorPlaceholder"),trigger:"blur"}],version:[{required:!0,validator:T,trigger:"blur"}],cover:[{required:!0,message:e("coverPlaceholder"),trigger:"change"}],type:[{required:!0,message:e("typePlaceholder"),trigger:"change"}],support_app:[{required:!0,message:e("typePlaceholder"),trigger:"change"}]});Q(async()=>{const u=await se();E.value=u.data,h.query.key&&$(h.query.key)});const C=()=>{a.value.support_app=""},$=u=>{m.value=!0,ne(u).then(l=>{a.value=Object.assign(a.value,l.data),m.value=!1}).catch(()=>{m.value=!1})},U=v([]);(async()=>{const{data:u}=await G();U.value=u})();const I=u=>{ue(u).then(l=>{J.alert(l.data?e("warningText"):e("successText"),e("warning"),{confirmButtonText:e("confirm"),callback:d=>{console.log(d)}})})},R=async u=>{await u.validate(async l=>{if(l){const d=h.query.key?pe:ie;m.value=!0,d(a.value.key,a.value).then(p=>{m.value=!1,H({message:e("onSaveSuccessText"),type:"success"}),setTimeout(()=>{window.addonActiveName="pluginList",b.push({path:"/tools/addon"})},650)}).catch(()=>{m.value=!1})}})};return de().then(({data:u})=>{k.value=u}),(u,l)=>{const d=W,p=X,B=re,V=Y,y=ee,P=le,S=te,j=ae,z=oe;return Z((c(),_("div",ce,[s("div",me,[s("div",{class:"left",onClick:l[0]||(l[0]=o=>t(b).push({path:"/tools/addon"}))},[ve,s("span",he,i(t(e)("returnToPreviousPage")),1)]),_e,s("span",ge,i(t(D)),1)]),r(j,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[r(S,{model:a.value,"label-width":"90px",ref_key:"formRef",ref:q,rules:N.value,class:"page-form"},{default:n(()=>[r(p,{label:t(e)("title"),prop:"title"},{default:n(()=>[r(d,{modelValue:a.value.title,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.title=o),clearable:"",placeholder:t(e)("titlePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("icon"),prop:"icon"},{default:n(()=>[s("div",null,[r(B,{modelValue:a.value.icon,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.icon=o)},null,8,["modelValue"]),s("p",ye,i(t(e)("iconPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("key"),prop:"key"},{default:n(()=>[s("div",null,[r(d,{modelValue:a.value.key,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.key=o),clearable:"",disabled:t(h).query.key,placeholder:t(e)("keyPlaceholder"),class:"input-width mr-[15px]"},null,8,["modelValue","disabled","placeholder"]),t(h).query.key?g("",!0):(c(),x(V,{key:0,type:"primary",disabled:a.value.key=="",onClick:l[4]||(l[4]=o=>I(a.value.key))},{default:n(()=>[w("官方市场标识检测")]),_:1},8,["disabled"])),s("p",fe,i(t(e)("keyPlaceholder1")),1),s("p",xe,i(t(e)("keyPlaceholder2")),1),k.value.length?(c(),_("p",be," 插件标识不能定义成黑名单中的值，插件标识黑名单："+i(k.value.join("，")),1)):g("",!0)])]),_:1},8,["label"]),r(p,{label:t(e)("desc"),prop:"desc"},{default:n(()=>[r(d,{type:"textarea",modelValue:a.value.desc,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.desc=o),clearable:"",placeholder:t(e)("descPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("author"),prop:"author"},{default:n(()=>[r(d,{modelValue:a.value.author,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.author=o),clearable:"",placeholder:t(e)("authorPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(p,{label:t(e)("version"),prop:"version"},{default:n(()=>[s("div",null,[r(d,{modelValue:a.value.version,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.version=o),clearable:"",placeholder:t(e)("versionPlaceholder"),class:"input-width",onkeyup:"this.value = this.value.replace(/[^\\d\\.]/g,'');"},null,8,["modelValue","placeholder"]),s("p",ke,i(t(e)("versionPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("cover"),prop:"cover"},{default:n(()=>[s("div",null,[r(B,{modelValue:a.value.cover,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.cover=o)},null,8,["modelValue"]),s("p",Ve,i(t(e)("coverPlaceholder1")),1)])]),_:1},8,["label"]),r(p,{label:t(e)("type"),prop:"type"},{default:n(()=>[s("div",null,[r(P,{modelValue:a.value.type,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.type=o),placeholder:t(e)("typePlaceholder"),class:"input-width",clearable:"",onChange:C},{default:n(()=>[(c(!0),_(A,null,L(E.value,(o,f)=>(c(),x(y,{key:f,label:o,value:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),s("p",Pe,i(t(e)("typePlaceholder1")),1),s("p",we,i(t(e)("typePlaceholder2")),1)])]),_:1},8,["label"]),a.value.type==="addon"?(c(),_(A,{key:0},[r(p,{label:t(e)("supportType")},{default:n(()=>[s("div",null,[r(P,{modelValue:a.value.support_type,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.support_type=o),class:"input-width",onChange:C},{default:n(()=>[r(y,{label:"通用插件",value:1}),r(y,{label:"支持应用",value:2})]),_:1},8,["modelValue"])])]),_:1},8,["label"]),a.value.support_type!=1?(c(),x(p,{key:0,label:t(e)("supportApp"),prop:"support_app"},{default:n(()=>[r(P,{modelValue:a.value.support_app,"onUpdate:modelValue":l[11]||(l[11]=o=>a.value.support_app=o),placeholder:t(e)("supportAppPlaceholder"),class:"input-width"},{default:n(()=>[(c(!0),_(A,null,L(U.value,(o,f)=>(c(),x(y,{label:o.title,value:o.key,key:f},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):g("",!0)],64)):g("",!0)]),_:1},8,["model","rules"])]),_:1}),m.value?g("",!0):(c(),_("div",Ae,[s("div",Ee,[r(V,{type:"primary",onClick:l[12]||(l[12]=o=>R(q.value))},{default:n(()=>[w(i(t(e)("GeneratePlugins")),1)]),_:1}),r(V,{onClick:l[13]||(l[13]=o=>t(b).push({path:"/tools/addon"}))},{default:n(()=>[w(i(t(e)("cancel")),1)]),_:1})])]))])),[[z,m.value]])}}});export{ul as default};
